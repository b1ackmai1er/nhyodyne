                      (     flx29fms.asm):00001                 OPT PAG
                      (     flx29fms.asm):00002                 TTL 6809 FILE MANAGEMENT SYSTEM
                      (     flx29fms.asm):00003                 PAG
                      (     flx29fms.asm):00004                 PRAGMA CD
                      (     flx29fms.asm):00005         *
                      (     flx29fms.asm):00006         * TSC 6809 DISK FILE MANAGEMENT SYSTEM
                      (     flx29fms.asm):00007         *
                      (     flx29fms.asm):00008         * COPYRIGHT (C) 1979 BY
                      (     flx29fms.asm):00009         *
                      (     flx29fms.asm):00010         * TECHNICAL SYSTEMS CONSULTANTS, INC.
                      (     flx29fms.asm):00011         * BOX 2574
                      (     flx29fms.asm):00012         * WEST LAFAYETTE, INDIANA 47906
                      (     flx29fms.asm):00013         * (317) 463-2502
                      (     flx29fms.asm):00014         *
                      (     flx29fms.asm):00015         * NOTE:
                      (     flx29fms.asm):00016         * AS OF 11/79 THE POINTS IN FMS WHICH LOAD A REGISTER
                      (     flx29fms.asm):00017         * WITH THE SECTOR LENGTH HAVE BEEN CHANGED TO SIMPLY
                      (     flx29fms.asm):00018         * CLEAR THE REGISTER (SINCE LDB #256 = LDB #0).
                      (     flx29fms.asm):00019         * ALL POINTS AFFECTED BY THIS CHANGE ARE FLAGGED WITH
                      (     flx29fms.asm):00020         * FOUR BACKSLASHES IN THE COMMENT FIELD (\\\\).
                      (     flx29fms.asm):00021         *
                      (     flx29fms.asm):00022         * CORRECTED WRITE FILE SECTOR MAP ROUTINE (WTFSM) 2/4/80.
                      (     flx29fms.asm):00023         
                      (     flx29fms.asm):00024         *
                      (     flx29fms.asm):00025         * THE FILE MANAGEMENT SYSTEM (FMS) RELIES
                      (     flx29fms.asm):00026         * ON THE USER DEFINITIONS OF FILE CONTROL
                      (     flx29fms.asm):00027         * BLOCKS (FCB) FOR EACH FILE OPENED.
                      (     flx29fms.asm):00028         * THE FCB STRUCTURE IS AS FOLLOWS:
                      (     flx29fms.asm):00029         *
                      (     flx29fms.asm):00030         * EACH FCB CONSUMES 320 BYTES OF RAM.
                      (     flx29fms.asm):00031         * EACH BYTE IS USED AS FOLLOWS:
                      (     flx29fms.asm):00032         *
                      (     flx29fms.asm):00033         * NAME  OFFSET FUNCTION
                      (     flx29fms.asm):00034         * ----  ------ --------
                      (     flx29fms.asm):00035         
     0000             (     flx29fms.asm):00036         FFC     EQU     0           FUNCTION OP CODE
     0001             (     flx29fms.asm):00037         FES     EQU     1           ERROR STATUS BYTE
     0002             (     flx29fms.asm):00038         FAS     EQU     2           ACTIVITY STATUS
     0003             (     flx29fms.asm):00039         FDN     EQU     3           DRIVE NUMBER
     0004             (     flx29fms.asm):00040         FFN     EQU     4           - 11 FILE NAME
     000C             (     flx29fms.asm):00041         FNE     EQU     12          - 14 NAME EXTENSION
     000F             (     flx29fms.asm):00042         FID     EQU     15          IDENTIFIER BYTE
     0010             (     flx29fms.asm):00043         FNU     EQU     16          FILE NUMBER
     0011             (     flx29fms.asm):00044         FSA     EQU     17          - 18 START DISK ADR.
     0013             (     flx29fms.asm):00045         FEA     EQU     19          - 20 END DISK ADDRESS
     0015             (     flx29fms.asm):00046         FSZ     EQU     21          - 22 FILE SIZE
     0017             (     flx29fms.asm):00047         FMP     EQU     23          - 24 FILE SECTOR MAP
     0019             (     flx29fms.asm):00048         FDT     EQU     25          - 27 CREATION DATE
     001C             (     flx29fms.asm):00049         FLP     EQU     28          - 29 FCB LIST POINTER
     001E             (     flx29fms.asm):00050         FCS     EQU     30          - 31 CURRENT SECTOR
     0020             (     flx29fms.asm):00051         FRN     EQU     32          - 33 RECORD NUMBER
     0022             (     flx29fms.asm):00052         FDI     EQU     34          DATA INDEX
     0023             (     flx29fms.asm):00053         FRI     EQU     35          RANDOM INDEX
     0024             (     flx29fms.asm):00054         FWB     EQU     36          - 46 NAME WORK BUFFER
     002F             (     flx29fms.asm):00055         FCD     EQU     47          - 49 CURRENT DIR. ADR.
     0032             (     flx29fms.asm):00056         FFD     EQU     50          - 52 FIRST DELETED DIR.
     0035             (     flx29fms.asm):00057         FLR     EQU     53          - 55 LAST RECORD PNTR
     0038             (     flx29fms.asm):00058         FNK     EQU     56          - 58 NEXT KEY POINTER
     003B             (     flx29fms.asm):00059         FSC     EQU     59          SPACE COMP. CNTR
     003C             (     flx29fms.asm):00060         FSP     EQU     60          - 63 SPARE BYTES
     0040             (     flx29fms.asm):00061         FSB     EQU     64          - 319 SECTOR BUFFER
                      (     flx29fms.asm):00062         
     003C             (     flx29fms.asm):00063         FMX EQU FSP MAX SECTOR NUMBER
     0037             (     flx29fms.asm):00064         SBC EQU FLR+2 SEQ. BLOCK COUNT
                      (     flx29fms.asm):00065         
                      (     flx29fms.asm):00066         *
                      (     flx29fms.asm):00067         * ALL DRIVER ROUTINES ARE REFERENCED
                      (     flx29fms.asm):00068         * THROUGH THIS TABLE.
                      (     flx29fms.asm):00069         
     DE00             (     flx29fms.asm):00070         DREAD   EQU     $DE00       DISK READ ROUTINE
     DE03             (     flx29fms.asm):00071         DWRITE  EQU     $DE03       DISK WRITE ROUTINE
     DE09             (     flx29fms.asm):00072         RESTOR  EQU     $DE09       HEAD RESTORE ROUTINE
     DE06             (     flx29fms.asm):00073         VERIFY  EQU     $DE06       WRITE VERIFY ROUTINE
     DE0C             (     flx29fms.asm):00074         DRIVE   EQU     $DE0C       DRIVE SELECT
     DE0F             (     flx29fms.asm):00075         CHECK   EQU     $DE0F       CHECK READY
     DE12             (     flx29fms.asm):00076         QUKCHK  EQU     $DE12       QUICK READY CHECK
     DE15             (     flx29fms.asm):00077         DINIT   EQU     $DE15       INITIALIZE DRIVERS
     DE18             (     flx29fms.asm):00078         DWARM   EQU     $DE18       USER WARMSTART ROUTINE
     DE1B             (     flx29fms.asm):00079         DSEEK   EQU     $DE1B       SEEK TO TRACK ROUTINE
                      (     flx29fms.asm):00080         
                      (     flx29fms.asm):00081         * ALL LOW LEVEL SYSTEM VARIABLES
                      (     flx29fms.asm):00082         * AND CONSTANTS ARE IN THIS AREA.
                      (     flx29fms.asm):00083         *
                      (     flx29fms.asm):00084         * SYSTEM CONSTANTS
                      (     flx29fms.asm):00085         
     0100             (     flx29fms.asm):00086         SL      EQU     256         SECTOR LENGTH
     000B             (     flx29fms.asm):00087         NL      EQU     11          NAME LENGTH
     0005             (     flx29fms.asm):00088         RTC     EQU     5           RETRY COUNT
     0007             (     flx29fms.asm):00089         RSC     EQU     7           SEEK RETRY COUNT
     0004             (     flx29fms.asm):00090         RS      EQU     4           RECORD START
     0010             (     flx29fms.asm):00091         IRS     EQU     16          INFO RECORD START
     0018             (     flx29fms.asm):00092         IRL     EQU     24          INFO RECORD LENGTH
     0004             (     flx29fms.asm):00093         IRFAS   EQU     $04         INFO MASK
     0016             (     flx29fms.asm):00094         LSTFC   EQU     22          LAST FUNCTION CODE
     007F             (     flx29fms.asm):00095         MAXSP   EQU     $7F         MAX SPACE COUNT
     0020             (     flx29fms.asm):00096         SPC     EQU     $20         ASCII SPACE
     0009             (     flx29fms.asm):00097         SCC     EQU     9           SPACE COMPRESSION CHAR.
     0018             (     flx29fms.asm):00098         DELC    EQU     $18         DELETE CHARACTER
     0004             (     flx29fms.asm):00099         NODR    EQU     4           NUMBER OF DRIVES
     0000             (     flx29fms.asm):00100         DTRK    EQU     0           DIRECTORY START TRACK
     0005             (     flx29fms.asm):00101         DSEC    EQU     5           DIR. START SECTOR
     0003             (     flx29fms.asm):00102         ISEC    EQU     3           INFO SECTOR NUMBER
     007F             (     flx29fms.asm):00103         TRMSK   EQU     $7F         TRACK MASK
     007F             (     flx29fms.asm):00104         SCMSK   EQU     $7F         SECTOR MASK
     004C             (     flx29fms.asm):00105         LSTTRK  EQU     76          LAST TRACK NUMBER
     000F             (     flx29fms.asm):00106         LSTSEC  EQU     15          LAST SECTOR NUMBER
     0010             (     flx29fms.asm):00107         RNFMSK  EQU     $10         REC NOT FOUND MASK
     0005             (     flx29fms.asm):00108         MAIND   EQU     $0005       MAIN DIRECTORY ADDRESS
                      (     flx29fms.asm):00109         
                      (     flx29fms.asm):00110         * DOS CONSTANTS
                      (     flx29fms.asm):00111         
     CC0E             (     flx29fms.asm):00112         DATE    EQU     $CC0E       SYSTEM DATA
     C709             (     flx29fms.asm):00113         LOCK    EQU     $C709       LOCK FMS
     C70C             (     flx29fms.asm):00114         UNLOCK  EQU     $C70C       UNLOCK FMS
     CCFC             (     flx29fms.asm):00115         PR1     EQU     $CCFC       PROCESS 1 REGISTER
                      (     flx29fms.asm):00116         
                      (     flx29fms.asm):00117         * SYSTEM ERROR NUMBER DEFINITIONS
                      (     flx29fms.asm):00118         *
                      (     flx29fms.asm):00119         * NAME  NUMBER MEANING
                      (     flx29fms.asm):00120         * ----  ------ -------
                      (     flx29fms.asm):00121         
     0000             (     flx29fms.asm):00122         NOER    EQU     0           NO ERROR
     0001             (     flx29fms.asm):00123         ICER    EQU     1           ILLEGAL FUNCTION CODE
     0002             (     flx29fms.asm):00124         FBER    EQU     2           FILE BUSY
     0003             (     flx29fms.asm):00125         FEER    EQU     3           FILE EXISTS
     0004             (     flx29fms.asm):00126         NFER    EQU     4           NO SUCH FILE
     0005             (     flx29fms.asm):00127         DRER    EQU     5           DIRECTORY ERROR
     0006             (     flx29fms.asm):00128         TMER    EQU     6           TOO MANY FILES
     0007             (     flx29fms.asm):00129         DFER    EQU     7           DISK FULL
     0008             (     flx29fms.asm):00130         EFER    EQU     8           END OF FILE
     0009             (     flx29fms.asm):00131         RDER    EQU     9           READ ERROR (CRC)
     000A             (     flx29fms.asm):00132         WTER    EQU     10          WRITE ERROR (CRC)
     000B             (     flx29fms.asm):00133         WPER    EQU     11          WRITE PROTECTED
     000C             (     flx29fms.asm):00134         DPER    EQU     12          DELETE PROTECTED
     000D             (     flx29fms.asm):00135         IFER    EQU     13          ILLEGAL FCB
     000E             (     flx29fms.asm):00136         DAER    EQU     14          ILLEGAL DISK ADDRESS
     000F             (     flx29fms.asm):00137         DNER    EQU     15          DRIVE NUMBER ERROR
     0010             (     flx29fms.asm):00138         NRER    EQU     16          NOT READY
     0011             (     flx29fms.asm):00139         ADER    EQU     17          ACCESS DENIED
     0012             (     flx29fms.asm):00140         STER    EQU     18          STATUS ERROR
     0013             (     flx29fms.asm):00141         IRER    EQU     19          INDEX RANGE ERROR
     0014             (     flx29fms.asm):00142         FIER    EQU     20          FMS INACTIVE
     0015             (     flx29fms.asm):00143         INER    EQU     21          ILLEGAL FILE NAME
     0016             (     flx29fms.asm):00144         CLER    EQU     22          CLOSE ERROR
     0017             (     flx29fms.asm):00145         FSER    EQU     23          FSM OVERFLOW ERROR
     0018             (     flx29fms.asm):00146         RRER    EQU     24          RECORD RANGE ERROR
     0019             (     flx29fms.asm):00147         RMER    EQU     25          RECORD MATCH ERROR
                      (     flx29fms.asm):00148         
                      (     flx29fms.asm):00149                 ORG $D400
                      (     flx29fms.asm):00150         
                      (     flx29fms.asm):00151         * FMS JUMP TABLES
                      (     flx29fms.asm):00152         *
                      (     flx29fms.asm):00153         * ALL CALLS TO THE FMS SHOULD ENTER
                      (     flx29fms.asm):00154         * THROUGH ONE OF THESE THREE POINTS.
                      (     flx29fms.asm):00155         
D400 7ED43A           (     flx29fms.asm):00156 [4]     FMSINT  JMP     INIT        FMS INITIALIZATION  $D400
D403 7ED45D           (     flx29fms.asm):00157 [4]     FMSCLS  JMP     EXCLS       FMS CLOSURE         $D403
D406 7ED47F           (     flx29fms.asm):00158 [4]     FMS     JMP     CMND        FMS COMMAND ENTRY   $D406
                      (     flx29fms.asm):00159         
                      (     flx29fms.asm):00160         * GLOBAL VARIABLE STORAGE
                      (     flx29fms.asm):00161         
D409                  (     flx29fms.asm):00162         FCBBAS  RMB     2           FCB BASE POINTER        $D409
D40B                  (     flx29fms.asm):00163         FCBSTR  RMB     2           CURRENT FCB             $D40B
D40D                  (     flx29fms.asm):00164         TEMP    RMB     2           TEMPORARY INDEX         $D40D
D40F                  (     flx29fms.asm):00165         DATAPT  RMB     2           DATA POINTER            $D40F
D411                  (     flx29fms.asm):00166         ETRIES  RMB     1           ERROR TRY COUNT         $D411
D412                  (     flx29fms.asm):00167         STRIES  RMB     1           SEEK TRY COUNT          $D412
D413                  (     flx29fms.asm):00168         CLD     RMB     2           CURRENT LOOK UP DIR     $D413
D415                  (     flx29fms.asm):00169         CUD     RMB     2           CURRENT USER DIR        $D415
D417                  (     flx29fms.asm):00170         DIRDN   RMB     1           DIRECTORY DRIVE NUM     $D417
D418                  (     flx29fms.asm):00171         BKLN    RMB     2           BACK LINK               $D418
D41A                  (     flx29fms.asm):00172         SINDIR  RMB     1           SINGLE DIR SEARCH       $D41A
D41B                  (     flx29fms.asm):00173         AVLPNT  RMB     2           AVAIL POINTER           $D41B
D41D                  (     flx29fms.asm):00174         SECMAP  RMB     NODR*6      SECTOR MAPS             $D41D
                      (     flx29fms.asm):00175         
                      (     flx29fms.asm):00176                 ORG     $D435
                      (     flx29fms.asm):00177         
D435 FF               (     flx29fms.asm):00178         VRFYFG  FCB     $FF         VERIFY FLAG
                      (     flx29fms.asm):00179         
D436 00000000         (     flx29fms.asm):00180         DRVINFO FCB     $00,$00,$00,$00
                      (     flx29fms.asm):00181         
                      (     flx29fms.asm):00182         * SYSTEM ENTRY ROUTINES
                      (     flx29fms.asm):00183         *
                      (     flx29fms.asm):00184         * THE FOLLOWING THREE ROUTINES SHOULD
                      (     flx29fms.asm):00185         * BE ACCESSED THROUGH THE SYSTEM JUMP
                      (     flx29fms.asm):00186         * TABLE.
                      (     flx29fms.asm):00187         
                      (     flx29fms.asm):00188         * INIT
                      (     flx29fms.asm):00189         *
                      (     flx29fms.asm):00190         * INIT IS THE FMS INITIALIZATION ROUTINE.
                      (     flx29fms.asm):00191         * NO ERRORS CAN OCCUR FROM THIS ROUTINE
                      (     flx29fms.asm):00192         * AND THE SYSTEM ASSUMES NO FILES ARE OPEN.
                      (     flx29fms.asm):00193         
D43A BDDE15           (     flx29fms.asm):00194 [8]     INIT    JSR     DINIT       INITIALIZE DRIVERS
D43D 8ED409           (     flx29fms.asm):00195 [3]             LDX     #FCBBAS     SET POINTER
D440 C60A             (     flx29fms.asm):00196 [2]             LDB     #10         SET COUNT
D442 8D11             (     flx29fms.asm):00197 [7]             BSR     INIT4       CLEAR SPACE
D444 8E0005           (     flx29fms.asm):00198 [3]             LDX     #MAIND      SET MAIN DIRECTORY
D447 BFD413           (     flx29fms.asm):00199 [6]             STX     CLD
D44A BFD415           (     flx29fms.asm):00200 [6]             STX     CUD
D44D 7FD41A           (     flx29fms.asm):00201 [7]             CLR     SINDIR      CLEAR SINGLE DIR
                      (     flx29fms.asm):00202         
D450 8ED41B           (     flx29fms.asm):00203 [3]     INIT2   LDX     #AVLPNT     POINT TO FMS SPC
D453 C61A             (     flx29fms.asm):00204 [2]             LDB     #26         SET COUNTER
                      (     flx29fms.asm):00205         
D455 6F80             (     flx29fms.asm):00206 [6+2]   INIT4   CLR     ,X+         CLEAR BYTE
D457 5A               (     flx29fms.asm):00207 [2]             DECB                DEC THE COUNT
D458 26FB             (     flx29fms.asm):00208 [3]             BNE     INIT4       REPEAT?
D45A 7EC70C           (     flx29fms.asm):00209 [4]             JMP     UNLOCK
                      (     flx29fms.asm):00210         
                      (     flx29fms.asm):00211         * EXCLS
                      (     flx29fms.asm):00212         *
                      (     flx29fms.asm):00213         * EXCLS IS THE FMS EXIT ROUTINE.
                      (     flx29fms.asm):00214         * EXECUTION OF THIS ROUTINE TELLS THE
                      (     flx29fms.asm):00215         * SYSTEM TO CLOSE ALL OPEN FILES.
                      (     flx29fms.asm):00216         
D45D BDC709           (     flx29fms.asm):00217 [8]     EXCLS   JSR     LOCK        LOCK FMS
D460 BED409           (     flx29fms.asm):00218 [6]     EXCLS1  LDX     FCBBAS      GET LINK BASE
D463 27EB             (     flx29fms.asm):00219 [3]             BEQ     INIT2       ANY FCBS LEFT?
D465 3088E4           (     flx29fms.asm):00220 [4+1]           LEAX    -FLP,X
D468 BFD40B           (     flx29fms.asm):00221 [6]             STX     FCBSTR      SET ACT. FCB
D46B 3420             (     flx29fms.asm):00222 [5+2]           PSHS    Y           SAVE REGISTER
D46D BDDADA           (     flx29fms.asm):00223 [8]             JSR     CLOSE       GO CLOSE FILE
D470 3520             (     flx29fms.asm):00224 [5+2]           PULS    Y           RESTORE REGISTER
D472 24EC             (     flx29fms.asm):00225 [3]             BCC     EXCLS1      REPEAT
                      (     flx29fms.asm):00226         
D474 BED40B           (     flx29fms.asm):00227 [6]             LDX     FCBSTR      SET TO FCB
D477 6F02             (     flx29fms.asm):00228 [6+1]           CLR     2,X         CLEAR FAS
D479 BDC70C           (     flx29fms.asm):00229 [8]             JSR     UNLOCK      UNLOCK FMS
D47C C6FF             (     flx29fms.asm):00230 [2]             LDB     #$FF        SET ERROR
D47E 39               (     flx29fms.asm):00231 [5]             RTS
                      (     flx29fms.asm):00232         
                      (     flx29fms.asm):00233         * CMND
                      (     flx29fms.asm):00234         *
                      (     flx29fms.asm):00235         * CMND IS THE FMS COMMAND INTERPRETER.
                      (     flx29fms.asm):00236         * ALL COMMAND CALLS TO FMS SHOULD BE
                      (     flx29fms.asm):00237         * THROUGH THIS ROUTINE.
                      (     flx29fms.asm):00238         
D47F 7DCCFC           (     flx29fms.asm):00239 [7]     CMND    TST     PR1         PROCESS ACTIVE?
D482 2703             (     flx29fms.asm):00240 [3]             BEQ     CMND1
D484 BDC709           (     flx29fms.asm):00241 [8]             JSR     LOCK        LOCK FMS
                      (     flx29fms.asm):00242         
D487 3424             (     flx29fms.asm):00243 [5+3]   CMND1   PSHS    B,Y         SAVE REGISTERS
D489 BFD40B           (     flx29fms.asm):00244 [6]             STX     FCBSTR      SET FCB STORAGE
D48C 6F01             (     flx29fms.asm):00245 [6+1]           CLR     FES,X       CLEAR ERRORS
D48E E684             (     flx29fms.asm):00246 [4+0]           LDB     FFC,X       GET FUNCTION CODE
D490 2622             (     flx29fms.asm):00247 [3]             BNE     CMND4       IO CODE?
                      (     flx29fms.asm):00248         
D492 E602             (     flx29fms.asm):00249 [4+1]           LDB     FAS,X       GET ACTIVITY BYTE
D494 271A             (     flx29fms.asm):00250 [3]             BEQ     CMND3
                      (     flx29fms.asm):00251         
D496 C102             (     flx29fms.asm):00252 [2]             CMPB    #2          IS IT WRITE?
D498 2711             (     flx29fms.asm):00253 [3]             BEQ     CMND2
D49A BDD5BC           (     flx29fms.asm):00254 [8]             JSR     SRDSEQ      GO DO READ
D49D BED40B           (     flx29fms.asm):00255 [6]     CMND15  LDX     FCBSTR      RESTORE X
D4A0 2526             (     flx29fms.asm):00256 [3]             BCS     CMND7       ERROR?
D4A2 7DCCFC           (     flx29fms.asm):00257 [7]             TST     PR1         PR 1 ACTIVE?
D4A5 2623             (     flx29fms.asm):00258 [3]             BNE     CMND8
D4A7 5F               (     flx29fms.asm):00259 [2]             CLRB                CLEAR ERRORS
D4A8 3524             (     flx29fms.asm):00260 [5+3]           PULS    B,Y         RESTORE REGISTERS
D4AA 39               (     flx29fms.asm):00261 [5]             RTS
                      (     flx29fms.asm):00262         
D4AB BDD6D7           (     flx29fms.asm):00263 [8]     CMND2   JSR     SWTSEQ      GO DO WRITE
D4AE 20ED             (     flx29fms.asm):00264 [3]             BRA     CMND15
                      (     flx29fms.asm):00265         
D4B0 C612             (     flx29fms.asm):00266 [2]     CMND3   LDB     #STER       SET STATUS ERROR
D4B2 2014             (     flx29fms.asm):00267 [3]             BRA     CMND7       REPORT ERROR
                      (     flx29fms.asm):00268         
D4B4 C116             (     flx29fms.asm):00269 [2]     CMND4   CMPB    #LSTFC      CHECK CODE
D4B6 2304             (     flx29fms.asm):00270 [3]             BLS     CMND5
D4B8 C601             (     flx29fms.asm):00271 [2]             LDB     #ICER       SET CODE ERROR
D4BA 200C             (     flx29fms.asm):00272 [3]             BRA     CMND7       REPORT IT
                      (     flx29fms.asm):00273         
D4BC 5A               (     flx29fms.asm):00274 [2]     CMND5   DECB                DEC THE CODE
D4BD 58               (     flx29fms.asm):00275 [2]             ASLB                CODE TIMES 2
D4BE 8ED4D2           (     flx29fms.asm):00276 [3]             LDX     #CODTBL     POINT TO TABLE
D4C1 AD95             (     flx29fms.asm):00277 [7+4]           JSR     [B,X]       GO DO ROUTINE
D4C3 BED40B           (     flx29fms.asm):00278 [6]             LDX     FCBSTR      RESTORE FCB PNTR
D4C6 2402             (     flx29fms.asm):00279 [3]             BCC     CMND8       ERRORS?
                      (     flx29fms.asm):00280         
D4C8 E701             (     flx29fms.asm):00281 [4+1]   CMND7   STB     FES,X       SET ERROR
                      (     flx29fms.asm):00282         
D4CA BDC70C           (     flx29fms.asm):00283 [8]     CMND8   JSR     UNLOCK
D4CD 6D01             (     flx29fms.asm):00284 [6+1]           TST     FES,X       TEST FOR ERROR
D4CF 3524             (     flx29fms.asm):00285 [5+3]           PULS    B,Y         RESTORE REGISTERS
D4D1 39               (     flx29fms.asm):00286 [5]             RTS
                      (     flx29fms.asm):00287         
                      (     flx29fms.asm):00288         * CODTBL
                      (     flx29fms.asm):00289         *
                      (     flx29fms.asm):00290         * CODTBL IS THE SYSTEM TABLE OF
                      (     flx29fms.asm):00291         * FUNCTION CODE ROUTINE ADDRESSES.
                      (     flx29fms.asm):00292         
D4D2 D98F             (     flx29fms.asm):00293         CODTBL  FDB     OPNRD       OPNRD   OPEN FOR READ
D4D4 D9E2             (     flx29fms.asm):00294                 FDB     OPNWT       OPNWT   OPEN FOR WRITE
D4D6 DB10             (     flx29fms.asm):00295                 FDB     OPNRW       OPNRW   OPEN FOR READ WRITE
D4D8 DADA             (     flx29fms.asm):00296                 FDB     CLOSE       CLOSE   CLOSE FILE
D4DA D5EA             (     flx29fms.asm):00297                 FDB     REWIND      REWIND  REWIND FILE
D4DC D825             (     flx29fms.asm):00298                 FDB     OPNDIR      OPNDIR  OPEN DIRECTORY
D4DE D840             (     flx29fms.asm):00299                 FDB     GETIR       GETIR   GET INFO RECORD
D4E0 D87F             (     flx29fms.asm):00300                 FDB     PUTIR       PUTIR   PUT INFO RECORD
D4E2 D649             (     flx29fms.asm):00301                 FDB     READSS      READSS  READ SINGLE SECTOR
D4E4 D6A7             (     flx29fms.asm):00302                 FDB     WRITSS      WRITSS  WRITE SINGLE SECTOR
D4E6 D972             (     flx29fms.asm):00303                 FDB     WRTDIR      WRTDIR  WRITE DIRECTORY
D4E8 DBED             (     flx29fms.asm):00304                 FDB     DELETE      DELETE  DELETE FILE
D4EA DB43             (     flx29fms.asm):00305                 FDB     RENAME      RENAME  RENAME FILE
D4EC D6A1             (     flx29fms.asm):00306                 FDB     RETRY4      RETRY4  APPEND FILES
D4EE DA9E             (     flx29fms.asm):00307                 FDB     NEXTS       NEXTS   NEXT SEQU. SECTOR
D4F0 D818             (     flx29fms.asm):00308                 FDB     OPNSIR      OPNSIR  OPEN SYSTEM INFO
D4F2 D577             (     flx29fms.asm):00309                 FDB     GETRAN      GETRAN  GET RANDOM CHARACTER
D4F4 D598             (     flx29fms.asm):00310                 FDB     PUTRAN      PUTRAN  WRITE RANDOM CHARACTER
D4F6 DB1E             (     flx29fms.asm):00311                 FDB     WTAPP       WTAPP   OPEN WRITE APPEND
D4F8 DDD5             (     flx29fms.asm):00312                 FDB     NXTRDY      NXTRDY  FIND NEXT READY DRIVE
D4FA DD13             (     flx29fms.asm):00313                 FDB     POSIT       POSIT   POSITION TO RECORD N
D4FC DCFD             (     flx29fms.asm):00314                 FDB     BKREC       BKREC   BACKUP ONE RECORD
                      (     flx29fms.asm):00315         
                      (     flx29fms.asm):00316         *
                      (     flx29fms.asm):00317         * THE FOLLOWING ROUTINES ARE THE SYSTEM
                      (     flx29fms.asm):00318         * LEVEL ROUTINES USED BY THE FMS.
                      (     flx29fms.asm):00319         
                      (     flx29fms.asm):00320         * SETFCB
                      (     flx29fms.asm):00321         *
                      (     flx29fms.asm):00322         * SETFCB IS USED TO TELL THE SYSTEM
                      (     flx29fms.asm):00323         * WHERE THE NEW FCB IS LOCATED.
                      (     flx29fms.asm):00324         * IT SETS UP A CHAINED STRUCTURE
                      (     flx29fms.asm):00325         * WITH FCBBAS AS THE BASE OF THE CHAIN.
                      (     flx29fms.asm):00326         *
                      (     flx29fms.asm):00327         *   ENTRY: NONE
                      (     flx29fms.asm):00328         *   EXIT:  CS IF FCB EXISTS
                      (     flx29fms.asm):00329         *          ALL REGISTERS CHANGED
                      (     flx29fms.asm):00330         
D4FE 8D20             (     flx29fms.asm):00331 [7]     SETFCB  BSR     FNDFCB      FIND FCB
D500 2605             (     flx29fms.asm):00332 [3]             BNE     SETFC2      ERROR?
D502 C602             (     flx29fms.asm):00333 [2]             LDB     #FBER       FILE BUSY
D504 1A01             (     flx29fms.asm):00334 [3]             ORCC    #1          SEC SHOW ERROR
D506 39               (     flx29fms.asm):00335 [5]             RTS
                      (     flx29fms.asm):00336         
D507 ED00             (     flx29fms.asm):00337 [5+1]   SETFC2  STD     0,X         SET FCB
D509 AE00             (     flx29fms.asm):00338 [5+1]           LDX     0,X         GET FCB POS
D50B 6F00             (     flx29fms.asm):00339 [6+1]           CLR     0,X         CLEAR LAST LINK
D50D 6F01             (     flx29fms.asm):00340 [6+1]           CLR     1,X         ALSO SHOWS NO ERROR
D50F 39               (     flx29fms.asm):00341 [5]             RTS
                      (     flx29fms.asm):00342         
                      (     flx29fms.asm):00343         * REMFCB
                      (     flx29fms.asm):00344         *
                      (     flx29fms.asm):00345         * REMFCB IS USED TO REMOVE AN ACTIVE
                      (     flx29fms.asm):00346         * FCB FROM THE SYSTEM FCB LIST.
                      (     flx29fms.asm):00347         *
                      (     flx29fms.asm):00348         *   ENTRY: NONE
                      (     flx29fms.asm):00349         *   EXIT:  CS IF FCB NOT FOUND
                      (     flx29fms.asm):00350         *          ALL REGISTERS CHANGED
                      (     flx29fms.asm):00351         
D510 8D0E             (     flx29fms.asm):00352 [7]     REMFCB  BSR     FNDFCB      FIND FCB
D512 2705             (     flx29fms.asm):00353 [3]             BEQ     REMFC2      ERROR?
D514 C60D             (     flx29fms.asm):00354 [2]             LDB     #IFER       SET ERROR CODE
D516 1A01             (     flx29fms.asm):00355 [3]             ORCC    #1          SEC SHOW ERROR
D518 39               (     flx29fms.asm):00356 [5]             RTS
                      (     flx29fms.asm):00357         
D519 EC94             (     flx29fms.asm):00358 [5+3]   REMFC2  LDD     [,X]       GET NEXT LINK
D51B ED00             (     flx29fms.asm):00359 [5+1]           STD     0,X         SAVE NEW VALUE
D51D 1CFE             (     flx29fms.asm):00360 [3]             ANDCC   #$FE        CLC CLEAR ERRORS
D51F 39               (     flx29fms.asm):00361 [5]             RTS
                      (     flx29fms.asm):00362         
                      (     flx29fms.asm):00363         * FNDFCB
                      (     flx29fms.asm):00364         *
                      (     flx29fms.asm):00365         * FNDFCB TRIES TO FIND THE FCB IN
                      (     flx29fms.asm):00366         * FCBSTR IN THE SYSTEM TABLE.
                      (     flx29fms.asm):00367         *
                      (     flx29fms.asm):00368         *   ENTRY: NONE
                      (     flx29fms.asm):00369         *   EXIT:  NE IF NOT FOUND
                      (     flx29fms.asm):00370         *          A & B DESTROYED
                      (     flx29fms.asm):00371         *          X POINTS TO FCB
                      (     flx29fms.asm):00372         
D520 FCD40B           (     flx29fms.asm):00373 [6]     FNDFCB  LDD     FCBSTR      PICKUP FCB
D523 C3001C           (     flx29fms.asm):00374 [4]             ADDD    #FLP        SET TO LIST PNTR
D526 8ED409           (     flx29fms.asm):00375 [3]             LDX     #FCBBAS     GET BASE LOC.
D529 10AE00           (     flx29fms.asm):00376 [6+1]   FNDFC3  LDY     0,X         CHECK FOR LIST END
D52C 2603             (     flx29fms.asm):00377 [3]             BNE     FNDFC4
D52E 1CFB             (     flx29fms.asm):00378 [3]             ANDCC   #$FB        SET NE BIT
D530 39               (     flx29fms.asm):00379 [5]             RTS
                      (     flx29fms.asm):00380         
D531 10A300           (     flx29fms.asm):00381 [7+1]   FNDFC4  CMPD    0,X         COMPARE VALUE
D534 2601             (     flx29fms.asm):00382 [3]             BNE     FNDFC6
D536 39               (     flx29fms.asm):00383 [5]             RTS                 RET WITH EQ
                      (     flx29fms.asm):00384         
D537 AE00             (     flx29fms.asm):00385 [5+1]   FNDFC6  LDX     0,X         MOVE TO NEXT FCB
D539 20EE             (     flx29fms.asm):00386 [3]             BRA     FNDFC3      REPEAT
                      (     flx29fms.asm):00387         
                      (     flx29fms.asm):00388         * CLRFCB
                      (     flx29fms.asm):00389         *
                      (     flx29fms.asm):00390         * CLRFCB CLEARS SELECTED SECTIONS OF
                      (     flx29fms.asm):00391         * THE CURRENT FCB.
                      (     flx29fms.asm):00392         *
                      (     flx29fms.asm):00393         *   ENTRY: NONE
                      (     flx29fms.asm):00394         *   EXIT:  ALL REGISTERS CHANGED
                      (     flx29fms.asm):00395         
D53B BED40B           (     flx29fms.asm):00396 [6]     CLRFCB  LDX     FCBSTR      GET FCB
D53E 4F               (     flx29fms.asm):00397 [2]             CLRA                CLEAR A BYTE
D53F 5F               (     flx29fms.asm):00398 [2]             CLRB                GET SECTOR LENGTH \\\\
D540 8D02             (     flx29fms.asm):00399 [7]             BSR     CLRFC2      CLEAR OUT
D542 C62F             (     flx29fms.asm):00400 [2]             LDB     #FSB-FSA
D544 A78811           (     flx29fms.asm):00401 [4+1]   CLRFC2  STA     FSA,X       CLEAR BYTE
D547 3001             (     flx29fms.asm):00402 [4+1]           LEAX    1,X         BUMP THE POINTER
D549 5A               (     flx29fms.asm):00403 [2]             DECB                DEC THE COUNT
D54A 26F8             (     flx29fms.asm):00404 [3]             BNE     CLRFC2      LOOP TIL DONE
D54C 39               (     flx29fms.asm):00405 [5]             RTS
                      (     flx29fms.asm):00406         
                      (     flx29fms.asm):00407         * COPNAM
                      (     flx29fms.asm):00408         *
                      (     flx29fms.asm):00409         * COPNAM WILL COPY THE NAME (NL BYTES)
                      (     flx29fms.asm):00410         * FROM FCB AREA FFN (FILE NAME) TO THE
                      (     flx29fms.asm):00411         * AREA FWB (WORK BUFFER).
                      (     flx29fms.asm):00412         *
                      (     flx29fms.asm):00413         *   ENTRY: NONE
                      (     flx29fms.asm):00414         *   EXIT:  ALL REGISTERS CHANGED
                      (     flx29fms.asm):00415         
D54D BED40B           (     flx29fms.asm):00416 [6]     COPNAM  LDX     FCBSTR      PICKUP FCB
D550 C60B             (     flx29fms.asm):00417 [2]             LDB     #NL         SET NAME LENGTH
D552 A604             (     flx29fms.asm):00418 [4+1]   COPNA2  LDA     FFN,X       GET CHARACTER
D554 A78824           (     flx29fms.asm):00419 [4+1]           STA     FWB,X       MOVE IT
D557 3001             (     flx29fms.asm):00420 [4+1]           LEAX    1,X         BUMP THE POINTER
D559 5A               (     flx29fms.asm):00421 [2]             DECB                DEC THE COUNTER
D55A 26F6             (     flx29fms.asm):00422 [3]             BNE     COPNA2
D55C 39               (     flx29fms.asm):00423 [5]             RTS
                      (     flx29fms.asm):00424         
                      (     flx29fms.asm):00425         * CMPNAM
                      (     flx29fms.asm):00426         *
                      (     flx29fms.asm):00427         * CMPNAM WILL COMPARE THE NAME (NL
                      (     flx29fms.asm):00428         * BYTES LONG) IN THE FCB AREA FWB
                      (     flx29fms.asm):00429         * (WORK BUFFER) TO THE CONTENTS OF
                      (     flx29fms.asm):00430         * FCB AREA FFN (FILE NAME).
                      (     flx29fms.asm):00431         *
                      (     flx29fms.asm):00432         *   ENTRY: NONE
                      (     flx29fms.asm):00433         *   EXIT:  NE IF NOT EQUAL
                      (     flx29fms.asm):00434         *          ALL REGISTERS CHANGED
                      (     flx29fms.asm):00435         
D55D BED40B           (     flx29fms.asm):00436 [6]     CMPNAM  LDX     FCBSTR      PICKUP FCB
D560 C60B             (     flx29fms.asm):00437 [2]             LDB     #NL         SET LENGTH
                      (     flx29fms.asm):00438         
D562 A604             (     flx29fms.asm):00439 [4+1]   CMPNA1  LDA     FFN,X       GET CHARACTER
D564 8A20             (     flx29fms.asm):00440 [2]             ORA     #$20        MAKE LOWERCASE
D566 3402             (     flx29fms.asm):00441 [5+1]           PSHS    A
D568 A68824           (     flx29fms.asm):00442 [4+1]           LDA     FWB,X       GET 2ND CHARACTER
D56B 8A20             (     flx29fms.asm):00443 [2]             ORA     #$20        MAKE LOWERCASE
D56D A1E0             (     flx29fms.asm):00444 [4+2]           CMPA    ,S+         COMPARE THEM
D56F 2605             (     flx29fms.asm):00445 [3]             BNE     CMPNA4      NOT EQUAL?
                      (     flx29fms.asm):00446         
D571 3001             (     flx29fms.asm):00447 [4+1]           LEAX    1,X         BUMP THE POINTER
D573 5A               (     flx29fms.asm):00448 [2]             DECB                DEC THE COUNTER
D574 26EC             (     flx29fms.asm):00449 [3]             BNE     CMPNA1      REPEAT
D576 39               (     flx29fms.asm):00450 [5]     CMPNA4  RTS
                      (     flx29fms.asm):00451         
                      (     flx29fms.asm):00452         * GETRAN   * FFC #17 *
                      (     flx29fms.asm):00453         *
                      (     flx29fms.asm):00454         * GETRAN GETS A RANDOM CHARACTER FROM
                      (     flx29fms.asm):00455         * THE CURRENT FSB.
                      (     flx29fms.asm):00456         *
                      (     flx29fms.asm):00457         *   ENTRY: FRI CONTAINS DESIRED INDEX
                      (     flx29fms.asm):00458         *   EXIT:  CS IF FRI OUT OF RANGE
                      (     flx29fms.asm):00459         *          A CONTAINS CHARACTER
                      (     flx29fms.asm):00460         *          B & X CHANGED
                      (     flx29fms.asm):00461         
D577 BED40B           (     flx29fms.asm):00462 [6]     GETRAN  LDX     FCBSTR      GET FCB
D57A E602             (     flx29fms.asm):00463 [4+1]           LDB     FAS,X       GET STATUS
D57C 54               (     flx29fms.asm):00464 [2]             LSRB                CHECK IF R OR RW
D57D 2479             (     flx29fms.asm):00465 [3]             BCC     REWIN2      GO SET ERROR
D57F E68823           (     flx29fms.asm):00466 [4+1]           LDB     FRI,X       GET RANDOM INDEX
D582 7ED608           (     flx29fms.asm):00467 [4]             JMP     RDSEQ0
                      (     flx29fms.asm):00468         
                      (     flx29fms.asm):00469         * PUTNXT
                      (     flx29fms.asm):00470         *
                      (     flx29fms.asm):00471         * PUTNXT PUTS THE CHARACTER IN A INTO
                      (     flx29fms.asm):00472         * THE NEXT AVAILABLE FSB LOCATION
                      (     flx29fms.asm):00473         * POINTED TO BY THE FDI.
                      (     flx29fms.asm):00474         *
                      (     flx29fms.asm):00475         *   ENTRY: A CONTAINS CHARACTER
                      (     flx29fms.asm):00476         *   EXIT:  CS IF LAST FSB POS. USED
                      (     flx29fms.asm):00477         *          B & X CHANGED
                      (     flx29fms.asm):00478         
D585 BED40B           (     flx29fms.asm):00479 [6]     PUTNXT  LDX     FCBSTR      PICKUP FCB
D588 E68822           (     flx29fms.asm):00480 [4+1]           LDB     FDI,X       GET DATA INDEX
D58B 6C8822           (     flx29fms.asm):00481 [6+1]           INC     FDI,X       BUMP FDI
D58E 3A               (     flx29fms.asm):00482 [3]             ABX                 ADD IN INDEX
D58F A78840           (     flx29fms.asm):00483 [4+1]           STA     FSB,X       PUT THE CHARACTER
D592 5C               (     flx29fms.asm):00484 [2]             INCB                BUMP IT
D593 261F             (     flx29fms.asm):00485 [3]             BNE     PUTRA2      OVER END OF FSB?
D595 1A01             (     flx29fms.asm):00486 [3]             ORCC    #1          SEC OVER END!
D597 39               (     flx29fms.asm):00487 [5]             RTS
                      (     flx29fms.asm):00488         
                      (     flx29fms.asm):00489         * PUTRAN   * FFC #18 *
                      (     flx29fms.asm):00490         *
                      (     flx29fms.asm):00491         * PUTRAN PUTS THE CHARACTER IN A
                      (     flx29fms.asm):00492         * IN THE FSB LOCATION INDEXED BY
                      (     flx29fms.asm):00493         * THE FRI.
                      (     flx29fms.asm):00494         *
                      (     flx29fms.asm):00495         *   ENTRY: A CONTAINS CHARACTER
                      (     flx29fms.asm):00496         *          FRI CONTAINS INDEX
                      (     flx29fms.asm):00497         *   EXIT:  CS IF FRI OUT OF RANGE
                      (     flx29fms.asm):00498         *          B & X CHANGED
                      (     flx29fms.asm):00499         
D598 BED40B           (     flx29fms.asm):00500 [6]     PUTRAN  LDX     FCBSTR      GET FCB
D59B E602             (     flx29fms.asm):00501 [4+1]           LDB     FAS,X       CHECK IF RW
D59D C403             (     flx29fms.asm):00502 [2]             ANDB    #3          MASK OFF
D59F C103             (     flx29fms.asm):00503 [2]             CMPB    #3          IS IT RW?
D5A1 2655             (     flx29fms.asm):00504 [3]             BNE     REWIN2      SKIP IF ERROR
D5A3 CA80             (     flx29fms.asm):00505 [2]             ORB     #$80        SET UPDATE BIT
D5A5 E702             (     flx29fms.asm):00506 [4+1]           STB     FAS,X       SAVE IT
D5A7 E60F             (     flx29fms.asm):00507 [4+1]           LDB     FID,X       CHECK WP
D5A9 C580             (     flx29fms.asm):00508 [2]             BITB    #$80
D5AB 260A             (     flx29fms.asm):00509 [3]             BNE     PUTRA4
D5AD E68823           (     flx29fms.asm):00510 [4+1]           LDB     FRI,X       GET RANDOM INDEX
D5B0 3A               (     flx29fms.asm):00511 [3]             ABX                 ADD IN INDEX
D5B1 A78840           (     flx29fms.asm):00512 [4+1]           STA     64,X        FSB,X PUT CHARACTER
                      (     flx29fms.asm):00513         
D5B4 1CFE             (     flx29fms.asm):00514 [3]     PUTRA2  ANDCC   #$FE        CLC CLEAR ERROR
D5B6 39               (     flx29fms.asm):00515 [5]             RTS
                      (     flx29fms.asm):00516         
D5B7 C60B             (     flx29fms.asm):00517 [2]     PUTRA4  LDB     #WPER       SET WP ERROR
D5B9 1A01             (     flx29fms.asm):00518 [3]             ORCC    #1          SEC SET ERROR
D5BB 39               (     flx29fms.asm):00519 [5]             RTS
                      (     flx29fms.asm):00520         
                      (     flx29fms.asm):00521         * SRDSEQ
                      (     flx29fms.asm):00522         *
                      (     flx29fms.asm):00523         * SRDSEQ IS THE HIGH LEVEL READ
                      (     flx29fms.asm):00524         * SEQUENTIAL CHARACTER ROUTINE.
                      (     flx29fms.asm):00525         * CONTROL CHARACTERS AND SPACE
                      (     flx29fms.asm):00526         * EXPANSION ARE HANDLED HERE UNLESS
                      (     flx29fms.asm):00527         * FSC IS NEGATIVE.
                      (     flx29fms.asm):00528         *
                      (     flx29fms.asm):00529         *   ENTRY: NONE
                      (     flx29fms.asm):00530         *   EXIT:  CS IF ERROR
                      (     flx29fms.asm):00531         *          B HAS ERROR NUMBER
                      (     flx29fms.asm):00532         *          A & X CHANGED
                      (     flx29fms.asm):00533         
D5BC A6883B           (     flx29fms.asm):00534 [4+1]   SRDSEQ  LDA     FSC,X       CHECK FOR SP. EXP.
D5BF 2B3C             (     flx29fms.asm):00535 [3]             BMI     RDSEQ       CONTROL IGNORE?
D5C1 2707             (     flx29fms.asm):00536 [3]             BEQ     SRDSE2      ACTIVE EXPANSION?
D5C3 6A883B           (     flx29fms.asm):00537 [6+1]           DEC     FSC,X       DEC THE SPACE COUNT
D5C6 8620             (     flx29fms.asm):00538 [2]             LDA     #SPC        SETUP SPACE
D5C8 201D             (     flx29fms.asm):00539 [3]             BRA     SRDSE7      FINISH UP
                      (     flx29fms.asm):00540         
D5CA 8D31             (     flx29fms.asm):00541 [7]     SRDSE2  BSR     RDSEQ       READ NEXT CHAR
D5CC 251B             (     flx29fms.asm):00542 [3]             BCS     SRDSE8      ERRORS?
D5CE 8118             (     flx29fms.asm):00543 [2]             CMPA    #DELC       IS IT DELETED?
D5D0 2215             (     flx29fms.asm):00544 [3]             BHI     SRDSE7      SKIP ALL SPECIALS
D5D2 27F6             (     flx29fms.asm):00545 [3]             BEQ     SRDSE2
D5D4 8109             (     flx29fms.asm):00546 [2]             CMPA    #SCC        SPACE COMP CHAR?
D5D6 260C             (     flx29fms.asm):00547 [3]             BNE     SRDSE6
D5D8 8D23             (     flx29fms.asm):00548 [7]             BSR     RDSEQ       GO GET COUNT
D5DA 250D             (     flx29fms.asm):00549 [3]             BCS     SRDSE8      ERROR?
D5DC BED40B           (     flx29fms.asm):00550 [6]             LDX     FCBSTR      RESTORE POINTER
D5DF A7883B           (     flx29fms.asm):00551 [4+1]           STA     FSC,X       SAVE COUNT
D5E2 20D8             (     flx29fms.asm):00552 [3]             BRA     SRDSEQ      REPEAT
                      (     flx29fms.asm):00553         
D5E4 4D               (     flx29fms.asm):00554 [2]     SRDSE6  TSTA                IS CHAR NULL?
D5E5 27E3             (     flx29fms.asm):00555 [3]             BEQ     SRDSE2      IGNORE IF SO
                      (     flx29fms.asm):00556         
D5E7 1CFE             (     flx29fms.asm):00557 [3]     SRDSE7  ANDCC   #$FE        CLC CLEAR ERROR
D5E9 39               (     flx29fms.asm):00558 [5]     SRDSE8  RTS
                      (     flx29fms.asm):00559         
                      (     flx29fms.asm):00560         * REWIND   * FFC #5 *
                      (     flx29fms.asm):00561         *
                      (     flx29fms.asm):00562         * REWIND WILL LOGICALLY REWIND THE
                      (     flx29fms.asm):00563         * FILE SPECIFIED IN THE FCB.
                      (     flx29fms.asm):00564         *
                      (     flx29fms.asm):00565         *   ENTRY: NONE
                      (     flx29fms.asm):00566         *   EXIT:  SAME AS RDNEXT
                      (     flx29fms.asm):00567         
D5EA BDDAC8           (     flx29fms.asm):00568 [8]     REWIND  JSR     DOSTAT      CHECK STATUS
D5ED 2509             (     flx29fms.asm):00569 [3]             BCS     REWIN2      ERROR?
D5EF 8501             (     flx29fms.asm):00570 [2]             BITA    #1          CHECK FOR R BIT
D5F1 2705             (     flx29fms.asm):00571 [3]             BEQ     REWIN2      ERROR?
D5F3 A784             (     flx29fms.asm):00572 [4+0]           STA     FFC,X       SET FFC
D5F5 7ED9A9           (     flx29fms.asm):00573 [4]             JMP     OPNRD1      GO SETUP FILE
                      (     flx29fms.asm):00574         
D5F8 C612             (     flx29fms.asm):00575 [2]     REWIN2  LDB     #STER       SET ERROR CODE
D5FA 1A01             (     flx29fms.asm):00576 [3]             ORCC    #1          SEC SHOW ERROR
D5FC 39               (     flx29fms.asm):00577 [5]             RTS
                      (     flx29fms.asm):00578         
                      (     flx29fms.asm):00579         * RDSEQ
                      (     flx29fms.asm):00580         *
                      (     flx29fms.asm):00581         * RDSEQ IS THE LOW LEVEL GET
                      (     flx29fms.asm):00582         * SEQUENTIAL CHARACTER ROUTINE.
                      (     flx29fms.asm):00583         *
                      (     flx29fms.asm):00584         *   ENTRY: NONE
                      (     flx29fms.asm):00585         *   EXIT:  CHAR IN A
                      (     flx29fms.asm):00586         *          CS IF ERROR
                      (     flx29fms.asm):00587         *          B & X DESTROYED
                      (     flx29fms.asm):00588         
D5FD BED40B           (     flx29fms.asm):00589 [6]     RDSEQ   LDX     FCBSTR      PICKUP FCB
D600 E68822           (     flx29fms.asm):00590 [4+1]           LDB     FDI,X       GET DATA INDEX
D603 270A             (     flx29fms.asm):00591 [3]             BEQ     RDSEQ1
D605 6C8822           (     flx29fms.asm):00592 [6+1]           INC     FDI,X       BUMP DATA INDEX
                      (     flx29fms.asm):00593         
D608 3A               (     flx29fms.asm):00594 [3]     RDSEQ0  ABX                 ADD IN OFFSET
D609 A68840           (     flx29fms.asm):00595 [4+1]           LDA     FSB,X       GET CHARACTER
D60C 1CFE             (     flx29fms.asm):00596 [3]             ANDCC   #$FE        CLC
D60E 39               (     flx29fms.asm):00597 [5]             RTS
                      (     flx29fms.asm):00598         
D60F 8D03             (     flx29fms.asm):00599 [7]     RDSEQ1  BSR     RDNEXT      GET NEXT RECORD
D611 24EA             (     flx29fms.asm):00600 [3]             BCC     RDSEQ       ERRORS?
D613 39               (     flx29fms.asm):00601 [5]             RTS
                      (     flx29fms.asm):00602         
                      (     flx29fms.asm):00603         * RDNEXT
                      (     flx29fms.asm):00604         *
                      (     flx29fms.asm):00605         * RDNEXT READS THE NEXT SEQUENTIAL
                      (     flx29fms.asm):00606         * RECORD IF IT EXISTS.
                      (     flx29fms.asm):00607         *
                      (     flx29fms.asm):00608         *   ENTRY: NONE
                      (     flx29fms.asm):00609         *   EXIT:  CS IF ERROR
                      (     flx29fms.asm):00610         *          B HAS ERROR NUMBER
                      (     flx29fms.asm):00611         *          A & X CHANGED
                      (     flx29fms.asm):00612         
D614 BED40B           (     flx29fms.asm):00613 [6]     RDNEXT  LDX     FCBSTR      PICKUP FCB
D617 EC8840           (     flx29fms.asm):00614 [5+1]           LDD     FSB,X       GET TRACK & SECTOR
D61A 6C8821           (     flx29fms.asm):00615 [6+1]           INC     FRN+1,X     BUMP REC NUM
D61D 2603             (     flx29fms.asm):00616 [3]             BNE     RDNEX1
D61F 6C8820           (     flx29fms.asm):00617 [6+1]           INC     FRN,X
                      (     flx29fms.asm):00618         
D622 10830000         (     flx29fms.asm):00619 [5]     RDNEX1  CMPD    #$0000      TEST IF 0 LINK
D626 271C             (     flx29fms.asm):00620 [3]             BEQ     RDNEX4      END OF FILE?
D628 ED881E           (     flx29fms.asm):00621 [5+1]   RDNEX2  STD     FCS,X       SET CURRENT ADR.
D62B 3402             (     flx29fms.asm):00622 [5+1]           PSHS    A
D62D 8604             (     flx29fms.asm):00623 [2]             LDA     #RS         SET RECORD START
D62F A78822           (     flx29fms.asm):00624 [4+1]           STA     FDI,X       SAVE IT
D632 3502             (     flx29fms.asm):00625 [5+1]           PULS    A
D634 8D13             (     flx29fms.asm):00626 [7]             BSR     READSS      GO DO READ
D636 2410             (     flx29fms.asm):00627 [3]             BCC     RDNEX8      ERRORS?
D638 C580             (     flx29fms.asm):00628 [2]             BITB    #$80        CHECK NOT READY
D63A 2704             (     flx29fms.asm):00629 [3]             BEQ     RDNEX3
D63C C610             (     flx29fms.asm):00630 [2]             LDB     #NRER       SET ERROR
D63E 2006             (     flx29fms.asm):00631 [3]             BRA     RDNEX6
                      (     flx29fms.asm):00632         
D640 C609             (     flx29fms.asm):00633 [2]     RDNEX3  LDB     #RDER       SET READ ERROR
D642 2002             (     flx29fms.asm):00634 [3]             BRA     RDNEX6
                      (     flx29fms.asm):00635         
D644 C608             (     flx29fms.asm):00636 [2]     RDNEX4  LDB     #EFER       SET EOF ERROR
D646 1A01             (     flx29fms.asm):00637 [3]     RDNEX6  ORCC    #1          SEC SHOW ERROR
D648 39               (     flx29fms.asm):00638 [5]     RDNEX8  RTS
                      (     flx29fms.asm):00639         
                      (     flx29fms.asm):00640         * READSS   * FFC #9 *
                      (     flx29fms.asm):00641         *
                      (     flx29fms.asm):00642         * READSS READS A SINGLE RECORD (SECTOR)
                      (     flx29fms.asm):00643         * FROM THE DISK.
                      (     flx29fms.asm):00644         *
                      (     flx29fms.asm):00645         *   ENTRY: NONE
                      (     flx29fms.asm):00646         *   EXIT:  CS IF READ ERROR
                      (     flx29fms.asm):00647         *          ALL REGISTERS CHANGED
                      (     flx29fms.asm):00648         
D649 8D25             (     flx29fms.asm):00649 [7]     READSS  BSR     CLRTRY      CLEAR TRY COUNTERS
D64B BED40B           (     flx29fms.asm):00650 [6]             LDX     FCBSTR      SET POINTER
D64E BDDE0C           (     flx29fms.asm):00651 [8]             JSR     DRIVE       DO DRIVE SEL
D651 2512             (     flx29fms.asm):00652 [3]             BCS     READS6
                      (     flx29fms.asm):00653         
D653 8D11             (     flx29fms.asm):00654 [7]     READS2  BSR     GETCUR      GET DISK ADDRESS
D655 BDDE00           (     flx29fms.asm):00655 [8]             JSR     DREAD       GO READ RECORD
D658 2603             (     flx29fms.asm):00656 [3]             BNE     READS4      ERRORS?
D65A 1CFE             (     flx29fms.asm):00657 [3]             ANDCC   #$FE        CLC CLEAR ERROR
D65C 39               (     flx29fms.asm):00658 [5]             RTS
                      (     flx29fms.asm):00659         
D65D 3404             (     flx29fms.asm):00660 [5+1]   READS4  PSHS    B           SAVE B
D65F 8D17             (     flx29fms.asm):00661 [7]             BSR     RETRY       CHECK IF RETRY
D661 3504             (     flx29fms.asm):00662 [5+1]           PULS    B           RESTORE B
D663 24EE             (     flx29fms.asm):00663 [3]             BCC     READS2      TRY AGAIN?
                      (     flx29fms.asm):00664         
D665 39               (     flx29fms.asm):00665 [5]     READS6  RTS
                      (     flx29fms.asm):00666         
                      (     flx29fms.asm):00667         * GETCUR
                      (     flx29fms.asm):00668         *
                      (     flx29fms.asm):00669         * GETCUR GETS THE CURRENT RECORD ADDRESS
                      (     flx29fms.asm):00670         * (TRACK AND SECTOR) INTO A & B.
                      (     flx29fms.asm):00671         * IF ILLEGAL ADDRESS, CARRY IS SET.
                      (     flx29fms.asm):00672         *
                      (     flx29fms.asm):00673         *   ENTRY: NONE
                      (     flx29fms.asm):00674         *   EXIT:  CS IF ILLEGAL ADR.
                      (     flx29fms.asm):00675         *          A = TRACK NUMBER
                      (     flx29fms.asm):00676         *          B = SECTOR NUMBER
                      (     flx29fms.asm):00677         *          X POINTS TO FSB
                      (     flx29fms.asm):00678         
D666 BED40B           (     flx29fms.asm):00679 [6]     GETCUR  LDX     FCBSTR      PICKUP FCB
D669 EC881E           (     flx29fms.asm):00680 [5+1]           LDD     FCS,X       GET TRACK & SECTOR
D66C 308840           (     flx29fms.asm):00681 [4+1]           LEAX    FSB,X       ADD FSB BIAS
D66F 39               (     flx29fms.asm):00682 [5]             RTS
                      (     flx29fms.asm):00683         
                      (     flx29fms.asm):00684         * CLRTRY
                      (     flx29fms.asm):00685         *
                      (     flx29fms.asm):00686         * CLRTRY CLEARS THE ERROR TRY COUNTERS
                      (     flx29fms.asm):00687         *
                      (     flx29fms.asm):00688         *   ENTRY: NONE
                      (     flx29fms.asm):00689         *   EXIT:  A CLEARED
                      (     flx29fms.asm):00690         
D670 4F               (     flx29fms.asm):00691 [2]     CLRTRY  CLRA                CLEAR A
D671 B7D411           (     flx29fms.asm):00692 [5]             STA     ETRIES      CLEAR COUNTERS
D674 B7D412           (     flx29fms.asm):00693 [5]             STA     STRIES
D677 39               (     flx29fms.asm):00694 [5]             RTS
                      (     flx29fms.asm):00695         
                      (     flx29fms.asm):00696         * RETRY
                      (     flx29fms.asm):00697         *
                      (     flx29fms.asm):00698         * RETRY WILL TEST THE TRY COUNTERS
                      (     flx29fms.asm):00699         * ETRIES AND STRIES TO SEE IF THEY
                      (     flx29fms.asm):00700         * ARE AT MAXIMUM.
                      (     flx29fms.asm):00701         * A RESTORE OPERATION IS PERFORMED
                      (     flx29fms.asm):00702         * IF NECESSARY.
                      (     flx29fms.asm):00703         *
                      (     flx29fms.asm):00704         *   ENTRY: NONE
                      (     flx29fms.asm):00705         *   EXIT:  CS IF NO MORE TRIES LEFT
                      (     flx29fms.asm):00706         
D678 C510             (     flx29fms.asm):00707 [2]     RETRY   BITB    #$10        CHECK IF SEEK ERROR
D67A 2611             (     flx29fms.asm):00708 [3]             BNE     RETRY2
D67C C580             (     flx29fms.asm):00709 [2]             BITB    #$80        CHECK NOT READY
D67E 2624             (     flx29fms.asm):00710 [3]             BNE     RETRY6
D680 F6D411           (     flx29fms.asm):00711 [5]             LDB     ETRIES      CHECK ERROR CNTR
D683 5C               (     flx29fms.asm):00712 [2]             INCB                BUMP IT ONE
D684 C105             (     flx29fms.asm):00713 [2]             CMPB    #RTC        IS IT MAXIMUM?
D686 2705             (     flx29fms.asm):00714 [3]             BEQ     RETRY2
                      (     flx29fms.asm):00715         
D688 F7D411           (     flx29fms.asm):00716 [5]             STB     ETRIES      SAVE COUNT
D68B 2014             (     flx29fms.asm):00717 [3]             BRA     RETRY4
                      (     flx29fms.asm):00718         
D68D 7FD411           (     flx29fms.asm):00719 [7]     RETRY2  CLR     ETRIES      CLEAR COUNTER
D690 F6D412           (     flx29fms.asm):00720 [5]             LDB     STRIES      CHECK SEEK CNTR
D693 5C               (     flx29fms.asm):00721 [2]             INCB                BUMP IT
D694 C107             (     flx29fms.asm):00722 [2]             CMPB    #RSC        IS IT MAXIMUM?
D696 270C             (     flx29fms.asm):00723 [3]             BEQ     RETRY6
D698 F7D412           (     flx29fms.asm):00724 [5]             STB     STRIES      SAVE COUNTER
D69B BED40B           (     flx29fms.asm):00725 [6]             LDX     FCBSTR
D69E BDDE09           (     flx29fms.asm):00726 [8]             JSR     RESTOR      GO RESTORE
                      (     flx29fms.asm):00727         
D6A1 1CFE             (     flx29fms.asm):00728 [3]     RETRY4  ANDCC   #$FE        CLC CLEAR ERROR
D6A3 39               (     flx29fms.asm):00729 [5]             RTS
                      (     flx29fms.asm):00730         
D6A4 1A01             (     flx29fms.asm):00731 [3]     RETRY6  ORCC    #1          SEC SET ERROR
D6A6 39               (     flx29fms.asm):00732 [5]             RTS
                      (     flx29fms.asm):00733         
                      (     flx29fms.asm):00734         * WRITSS   * FFC #10 *
                      (     flx29fms.asm):00735         *
                      (     flx29fms.asm):00736         * WRITSS IS THE SYSTEM WRITE SINGLE
                      (     flx29fms.asm):00737         * SECTOR ROUTINE.
                      (     flx29fms.asm):00738         *
                      (     flx29fms.asm):00739         *   ENTRY: NONE
                      (     flx29fms.asm):00740         *   EXIT:  CS IF WRITE ERROR
                      (     flx29fms.asm):00741         *          ALL REGISTERS CHANGED
                      (     flx29fms.asm):00742         
D6A7 8DC7             (     flx29fms.asm):00743 [7]     WRITSS  BSR     CLRTRY      CLEAR TRY COUNTERS
D6A9 BED40B           (     flx29fms.asm):00744 [6]             LDX     FCBSTR      SET POINTER
D6AC BDDE0C           (     flx29fms.asm):00745 [8]             JSR     DRIVE       DO DRIVE SEL
D6AF 2520             (     flx29fms.asm):00746 [3]             BCS     WRITS6
                      (     flx29fms.asm):00747         
D6B1 BED40B           (     flx29fms.asm):00748 [6]     WRITS2  LDX     FCBSTR      SET POINTER
D6B4 8DB0             (     flx29fms.asm):00749 [7]             BSR     GETCUR      GET CURRENT SEC
D6B6 BDDE03           (     flx29fms.asm):00750 [8]             JSR     DWRITE      DO ACTUAL WRITE
D6B9 260A             (     flx29fms.asm):00751 [3]             BNE     WRITS4      ERRORS?
                      (     flx29fms.asm):00752         
D6BB B6D435           (     flx29fms.asm):00753 [5]             LDA     VRFYFG      VERIFY SECTOR?
D6BE 2737             (     flx29fms.asm):00754 [3]             BEQ     SWTSE6      NO VERIFY
                      (     flx29fms.asm):00755         
D6C0 BDDE06           (     flx29fms.asm):00756 [8]             JSR     VERIFY      GO DO VERIFY
D6C3 2732             (     flx29fms.asm):00757 [3]             BEQ     SWTSE6      ERROR?
                      (     flx29fms.asm):00758         
D6C5 C540             (     flx29fms.asm):00759 [2]     WRITS4  BITB    #$40        CHECK IF W.P.
D6C7 260B             (     flx29fms.asm):00760 [3]             BNE     WRITS8
                      (     flx29fms.asm):00761         
D6C9 3404             (     flx29fms.asm):00762 [5+1]           PSHS    B           SAVE STATUS
D6CB 8DAB             (     flx29fms.asm):00763 [7]             BSR     RETRY       RETRY?
D6CD 3504             (     flx29fms.asm):00764 [5+1]           PULS    B           RESTORE STATUS
D6CF 24E0             (     flx29fms.asm):00765 [3]             BCC     WRITS2      TRY AGAIN
D6D1 39               (     flx29fms.asm):00766 [5]     WRITS6  RTS                 ERROR RETURN
                      (     flx29fms.asm):00767         
D6D2 C620             (     flx29fms.asm):00768 [2]     WRITS7  LDB     #$20        SET ERROR
D6D4 1A01             (     flx29fms.asm):00769 [3]     WRITS8  ORCC    #1          SHOW ERROR
D6D6 39               (     flx29fms.asm):00770 [5]             RTS                 ERROR RETURN
                      (     flx29fms.asm):00771         
                      (     flx29fms.asm):00772         * SWTSEQ
                      (     flx29fms.asm):00773         *
                      (     flx29fms.asm):00774         * SWTSEQ IS THE HIGH LEVEL WRITE
                      (     flx29fms.asm):00775         * SEQUENTIAL CHARACTER ROUTINE.
                      (     flx29fms.asm):00776         * SPACE COMPRESSION IS HANDLED HERE
                      (     flx29fms.asm):00777         * UNLESS FSC IS NEGATIVE.
                      (     flx29fms.asm):00778         *
                      (     flx29fms.asm):00779         *   ENTRY: NONE
                      (     flx29fms.asm):00780         *   EXIT:  CS IF ERROR
                      (     flx29fms.asm):00781         *          B HAS ERROR NUMBER
                      (     flx29fms.asm):00782         *          A & X CHANGED
                      (     flx29fms.asm):00783         
D6D7 BED40B           (     flx29fms.asm):00784 [6]     SWTSEQ  LDX     FCBSTR      PICKUP FCB
D6DA E6883B           (     flx29fms.asm):00785 [4+1]           LDB     FSC,X       GET SPC COUNT
D6DD 2B3D             (     flx29fms.asm):00786 [3]             BMI     WTSEQ       WRITE IF NEG.
D6DF 8120             (     flx29fms.asm):00787 [2]             CMPA    #SPC        IS CHARACTER SPACE?
D6E1 260F             (     flx29fms.asm):00788 [3]             BNE     SWTSE4
D6E3 5C               (     flx29fms.asm):00789 [2]             INCB                BUMP THE COUNT
D6E4 E7883B           (     flx29fms.asm):00790 [4+1]           STB     FSC,X       SAVE IT
D6E7 C17F             (     flx29fms.asm):00791 [2]             CMPB    #MAXSP      MAXIMUM?
D6E9 260C             (     flx29fms.asm):00792 [3]             BNE     SWTSE6
D6EB 200D             (     flx29fms.asm):00793 [3]             BRA     PUTSPC      ** FIX FOR 128 SPACES **
                      (     flx29fms.asm):00794         
D6ED 8D0B             (     flx29fms.asm):00795 [7]     SWTSE2  BSR     PUTSPC      GO PUT SPACES
D6EF 24E6             (     flx29fms.asm):00796 [3]             BCC     SWTSEQ      ERRORS?
D6F1 39               (     flx29fms.asm):00797 [5]             RTS
                      (     flx29fms.asm):00798         
D6F2 5D               (     flx29fms.asm):00799 [2]     SWTSE4  TSTB                COUNT ZERO?
D6F3 2727             (     flx29fms.asm):00800 [3]             BEQ     WTSEQ
D6F5 20F6             (     flx29fms.asm):00801 [3]             BRA     SWTSE2      DO SPACES
                      (     flx29fms.asm):00802         
D6F7 1CFE             (     flx29fms.asm):00803 [3]     SWTSE6  ANDCC   #$FE        CLC CLEAR ERRORS
D6F9 39               (     flx29fms.asm):00804 [5]             RTS
                      (     flx29fms.asm):00805         
                      (     flx29fms.asm):00806         * PUTSPC
                      (     flx29fms.asm):00807         *
                      (     flx29fms.asm):00808         * PUTSPC IS THE ROUTINE WHICH WRITES
                      (     flx29fms.asm):00809         * THE SPACE COMPRESSION CODE AND THE
                      (     flx29fms.asm):00810         * SPACE COUNT.
                      (     flx29fms.asm):00811         *
                      (     flx29fms.asm):00812         *   ENTRY: B HAS COUNT
                      (     flx29fms.asm):00813         *   EXIT:  A PRESERVED
                      (     flx29fms.asm):00814         
D6FA 3402             (     flx29fms.asm):00815 [5+1]   PUTSPC  PSHS    A           SAVE CHAR
D6FC C101             (     flx29fms.asm):00816 [2]             CMPB    #1          IS COUNT 1?
D6FE 2604             (     flx29fms.asm):00817 [3]             BNE     PUTSP2
D700 8620             (     flx29fms.asm):00818 [2]             LDA     #$20        SETUP SPACE
D702 2010             (     flx29fms.asm):00819 [3]             BRA     PUTSP4      GO WRITE
                      (     flx29fms.asm):00820         
D704 8609             (     flx29fms.asm):00821 [2]     PUTSP2  LDA     #SCC        SETUP SCC
D706 8D14             (     flx29fms.asm):00822 [7]             BSR     WTSEQ       WRITE IT OUT
D708 3502             (     flx29fms.asm):00823 [5+1]           PULS    A
D70A 250F             (     flx29fms.asm):00824 [3]             BCS     PUTSP6      ERROR?
D70C 3402             (     flx29fms.asm):00825 [5+1]           PSHS    A           SAVE CHAR
D70E BED40B           (     flx29fms.asm):00826 [6]             LDX     FCBSTR      PICKUP FCB
D711 A6883B           (     flx29fms.asm):00827 [4+1]           LDA     FSC,X       GET COUNT
D714 6F883B           (     flx29fms.asm):00828 [6+1]   PUTSP4  CLR     FSC,X   CLEAR COUNT
D717 8D03             (     flx29fms.asm):00829 [7]             BSR     WTSEQ       WRITE COUNT
D719 3502             (     flx29fms.asm):00830 [5+1]           PULS    A           RESTORE CHAR
D71B 39               (     flx29fms.asm):00831 [5]     PUTSP6  RTS
                      (     flx29fms.asm):00832         
                      (     flx29fms.asm):00833         * WTSEQ
                      (     flx29fms.asm):00834         *
                      (     flx29fms.asm):00835         * WTSEQ WRITES THE NEXT CHARACTER TO
                      (     flx29fms.asm):00836         * THE FSB AREA OF THE FCB.
                      (     flx29fms.asm):00837         *
                      (     flx29fms.asm):00838         *   ENTRY: A HAS CHARACTER
                      (     flx29fms.asm):00839         *   EXIT:  CS IF ERROR
                      (     flx29fms.asm):00840         *          B HAS ERROR NUMBER
                      (     flx29fms.asm):00841         *          X CHANGED
                      (     flx29fms.asm):00842         
D71C BED40B           (     flx29fms.asm):00843 [6]     WTSEQ   LDX     FCBSTR      GET FCB POINTER
D71F E602             (     flx29fms.asm):00844 [4+1]           LDB     FAS,X       GET ACTIVE STATUS
D721 C102             (     flx29fms.asm):00845 [2]             CMPB    #2          IS IT WRITE?
D723 1026FED1         (     flx29fms.asm):00846 [5+?]           LBNE    REWIN2      ERROR IF NOT
D727 E68822           (     flx29fms.asm):00847 [4+1]           LDB     FDI,X       GET INDEX
D72A C104             (     flx29fms.asm):00848 [2]             CMPB    #RS         IS IT BEGINNING?
D72C 2608             (     flx29fms.asm):00849 [3]             BNE     WTSEQ2
D72E 3402             (     flx29fms.asm):00850 [5+1]           PSHS    A           SAVE CHAR.
D730 8D21             (     flx29fms.asm):00851 [7]             BSR     WTNEXT      GO WRITE RECORD
D732 3502             (     flx29fms.asm):00852 [5+1]           PULS    A           RESTORE CHAR.
D734 250F             (     flx29fms.asm):00853 [3]             BCS     WTSEQ4      ERRORS?
                      (     flx29fms.asm):00854         
D736 BDD585           (     flx29fms.asm):00855 [8]     WTSEQ2  JSR     PUTNXT      PUT CHARACTER
D739 240A             (     flx29fms.asm):00856 [3]             BCC     WTSEQ4      LAST SPACE USED?
D73B C604             (     flx29fms.asm):00857 [2]             LDB     #RS         SET RECORD START
D73D BED40B           (     flx29fms.asm):00858 [6]             LDX     FCBSTR      POINT TO FCB
D740 E78822           (     flx29fms.asm):00859 [4+1]           STB     FDI,X       SET INDEX
D743 1CFE             (     flx29fms.asm):00860 [3]             ANDCC   #$FE        CLC CLEAR ERRORS
D745 39               (     flx29fms.asm):00861 [5]     WTSEQ4  RTS
                      (     flx29fms.asm):00862         
                      (     flx29fms.asm):00863         * CLRLRN
                      (     flx29fms.asm):00864         
D746 BED40B           (     flx29fms.asm):00865 [6]     CLRLRN  LDX     FCBSTR      GET POINTER
D749 4F               (     flx29fms.asm):00866 [2]             CLRA
D74A 5F               (     flx29fms.asm):00867 [2]             CLRB
D74B ED8820           (     flx29fms.asm):00868 [5+1]           STD     FRN,X       CLEAR LRN
D74E ED8842           (     flx29fms.asm):00869 [5+1]           STD     FSB+2,X     CLEAR ACTUAL RN
D751 2027             (     flx29fms.asm):00870 [3]             BRA     WTNEX1      GO WRITE NEXT
                      (     flx29fms.asm):00871         
                      (     flx29fms.asm):00872         * WTNEXT
                      (     flx29fms.asm):00873         *
                      (     flx29fms.asm):00874         * WTNEXT WRITES THE NEXT RECORD.
                      (     flx29fms.asm):00875         *
                      (     flx29fms.asm):00876         *   ENTRY: X = FCB
                      (     flx29fms.asm):00877         *   EXIT:  CS IF ERROR
                      (     flx29fms.asm):00878         *          REGISTERS CHANGED
                      (     flx29fms.asm):00879         
D753 E68812           (     flx29fms.asm):00880 [4+1]   WTNEXT  LDB     FSA+1,X     FIRST RECORD?
D756 2622             (     flx29fms.asm):00881 [3]             BNE     WTNEX1
D758 E68817           (     flx29fms.asm):00882 [4+1]           LDB     FMP,X       CHECK FOR RANDOM
D75B 2744             (     flx29fms.asm):00883 [3]             BEQ     ASNNXT
D75D 6F8817           (     flx29fms.asm):00884 [6+1]           CLR     FMP,X       CLEAR FLAG
D760 8D3F             (     flx29fms.asm):00885 [7]             BSR     ASNNXT      GO ASSIGN
D762 252A             (     flx29fms.asm):00886 [3]             BCS     GETFS2      ERROR?
D764 8DE0             (     flx29fms.asm):00887 [7]             BSR     CLRLRN      CLEAR LRN
D766 2526             (     flx29fms.asm):00888 [3]             BCS     GETFS2      ERROR?
D768 8DDC             (     flx29fms.asm):00889 [7]             BSR     CLRLRN      CLEAR NEXT
D76A 2522             (     flx29fms.asm):00890 [3]             BCS     GETFS2      ERROR?
D76C BED40B           (     flx29fms.asm):00891 [6]             LDX     FCBSTR      GET FCB
D76F C602             (     flx29fms.asm):00892 [2]             LDB     #2          SET FSM COUNT
D771 E78817           (     flx29fms.asm):00893 [4+1]           STB     FMP,X
D774 EC8811           (     flx29fms.asm):00894 [5+1]           LDD     FSA,X       GET START ADDR
D777 7EDC99           (     flx29fms.asm):00895 [4]             JMP     UPDF75      GO DO UPDATE
                      (     flx29fms.asm):00896         
D77A 8D0E             (     flx29fms.asm):00897 [7]     WTNEX1  BSR     GETFST      GET FIRST AVAIL
D77C BED40B           (     flx29fms.asm):00898 [6]             LDX     FCBSTR      SET FCB PNTR
D77F ED8840           (     flx29fms.asm):00899 [5+1]           STD     FSB,X       SET FORWARD LINK
D782 BDD6A7           (     flx29fms.asm):00900 [8]             JSR     WRITSS      WRITE RECORD
D785 241A             (     flx29fms.asm):00901 [3]             BCC     ASNNXT      ERROR?
D787 7EDBD8           (     flx29fms.asm):00902 [4]             JMP     WRTERR      REPORT ERROR
                      (     flx29fms.asm):00903         
                      (     flx29fms.asm):00904         * GETFST
                      (     flx29fms.asm):00905         *
                      (     flx29fms.asm):00906         * GETFST LOADS THE FIRST AVAILABLE
                      (     flx29fms.asm):00907         * SECTOR ADDRESS INTO A & B.
                      (     flx29fms.asm):00908         *
                      (     flx29fms.asm):00909         *   ENTRY: NONE
                      (     flx29fms.asm):00910         *   EXIT:  EQ IF FSTAVL = 00
                      (     flx29fms.asm):00911         *          X UNCHANGED
                      (     flx29fms.asm):00912         *          A & B = FSTAVL H & L
                      (     flx29fms.asm):00913         
D78A 8D03             (     flx29fms.asm):00914 [7]     GETFST  BSR     FSECMP      FIND SECTOR MAP
D78C EC00             (     flx29fms.asm):00915 [5+1]           LDD     0,X         GET FIRST AVAIL.
D78E 39               (     flx29fms.asm):00916 [5]     GETFS2  RTS
                      (     flx29fms.asm):00917         
                      (     flx29fms.asm):00918         * FSECMP
                      (     flx29fms.asm):00919         *
                      (     flx29fms.asm):00920         * FSECMP FINDS THE SECTOR MAP
                      (     flx29fms.asm):00921         * CORRESPONDING TO THE CURRENT
                      (     flx29fms.asm):00922         * DRIVE SELECTED IN THE FCB.
                      (     flx29fms.asm):00923         *
                      (     flx29fms.asm):00924         *   ENTRY: NONE
                      (     flx29fms.asm):00925         *   EXIT:  EQ IF AVAIL NOT SET
                      (     flx29fms.asm):00926         *          X POINTS TO SECTOR MAP
                      (     flx29fms.asm):00927         
D78F BED40B           (     flx29fms.asm):00928 [6]     FSECMP  LDX     FCBSTR      PICKUP FCB
D792 E603             (     flx29fms.asm):00929 [4+1]           LDB     FDN,X       GET DRIVE NUMBER
D794 8606             (     flx29fms.asm):00930 [2]             LDA     #6          MULTIPLY TIMES 6
D796 3D               (     flx29fms.asm):00931 [11]            MUL
D797 8ED41D           (     flx29fms.asm):00932 [3]             LDX     #SECMAP     POINT TO MAPS
D79A 3A               (     flx29fms.asm):00933 [3]             ABX                 FIX POINTER
D79B BFD41B           (     flx29fms.asm):00934 [6]             STX     AVLPNT      SET POINTER
D79E 6D00             (     flx29fms.asm):00935 [6+1]           TST     0,X         IS AVAIL EMPTY?
D7A0 39               (     flx29fms.asm):00936 [5]             RTS
                      (     flx29fms.asm):00937         
                      (     flx29fms.asm):00938         * ASNNXT
                      (     flx29fms.asm):00939         *
                      (     flx29fms.asm):00940         * ASNNXT ASSIGNS THE NEXT AVAILABLE
                      (     flx29fms.asm):00941         * RECORD TO THE CURRENT OPEN WRITE
                      (     flx29fms.asm):00942         * FILE POINTED TO BY THE FCB.
                      (     flx29fms.asm):00943         *
                      (     flx29fms.asm):00944         *   ENTRY: NONE
                      (     flx29fms.asm):00945         *   EXIT:  CS IF ERROR
                      (     flx29fms.asm):00946         *          ALL REGISTERS CHANGED
                      (     flx29fms.asm):00947         
D7A1 8DE7             (     flx29fms.asm):00948 [7]     ASNNXT  BSR     GETFST      GET FSTAVL
D7A3 2605             (     flx29fms.asm):00949 [3]             BNE     ASNNX2      IS IT ZERO?
D7A5 C607             (     flx29fms.asm):00950 [2]             LDB     #DFER       DISK FULL!
D7A7 1A01             (     flx29fms.asm):00951 [3]     ASNNX1  ORCC    #1          SEC SET ERROR
D7A9 39               (     flx29fms.asm):00952 [5]             RTS
                      (     flx29fms.asm):00953         
D7AA BED40B           (     flx29fms.asm):00954 [6]     ASNNX2  LDX     FCBSTR      GET FCB POINTER
D7AD ED8813           (     flx29fms.asm):00955 [5+1]           STD     FEA,X       SET END ADDRESS
D7B0 6D8812           (     flx29fms.asm):00956 [6+1]           TST     FSA+1,X     IS THIS FIRST?
D7B3 2603             (     flx29fms.asm):00957 [3]             BNE     ASNNX4      JUMP AHEAD IF NOT
D7B5 ED8811           (     flx29fms.asm):00958 [5+1]           STD     FSA,X       SET START ADDRESS
                      (     flx29fms.asm):00959         
D7B8 6C8816           (     flx29fms.asm):00960 [6+1]   ASNNX4  INC     FSZ+1,X     BUMP FILE SIZE
D7BB 2603             (     flx29fms.asm):00961 [3]             BNE     ASNNX6
D7BD 6C8815           (     flx29fms.asm):00962 [6+1]           INC     FSZ,X       FIX MSB
                      (     flx29fms.asm):00963         
D7C0 6D8817           (     flx29fms.asm):00964 [6+1]   ASNNX6  TST     FMP,X       CHECK FOR RANDOM
D7C3 270B             (     flx29fms.asm):00965 [3]             BEQ     ASNN65
D7C5 BDDC5A           (     flx29fms.asm):00966 [8]             JSR     UPDFSM      UPDATE FSM ENTRY
D7C8 25DD             (     flx29fms.asm):00967 [3]             BCS     ASNNX1      ERROR?
D7CA BED40B           (     flx29fms.asm):00968 [6]             LDX     FCBSTR      GET FCB
D7CD EC8813           (     flx29fms.asm):00969 [5+1]           LDD     FEA,X       GET END ADDRESS
                      (     flx29fms.asm):00970         
D7D0 BDD628           (     flx29fms.asm):00971 [8]     ASNN65  JSR     RDNEX2      READ NEXT RECORD
D7D3 25D2             (     flx29fms.asm):00972 [3]             BCS     ASNNX1      READ ERROR?
D7D5 BED40B           (     flx29fms.asm):00973 [6]             LDX     FCBSTR      POINT TO FCB
D7D8 EC8840           (     flx29fms.asm):00974 [5+1]           LDD     FSB,X       GET FOR. LINK
D7DB 3406             (     flx29fms.asm):00975 [5+2]           PSHS    A,B         SAVE LINK
D7DD 8DB0             (     flx29fms.asm):00976 [7]             BSR     FSECMP      FIND SECTOR MAP
D7DF 3506             (     flx29fms.asm):00977 [5+2]           PULS    A,B         RESTORE LINK
D7E1 ED00             (     flx29fms.asm):00978 [5+1]           STD     0,X         SET FIRST AVAIL
D7E3 260A             (     flx29fms.asm):00979 [3]             BNE     ASNNX7      FULL DISK??
                      (     flx29fms.asm):00980         
D7E5 6F02             (     flx29fms.asm):00981 [6+1]           CLR     2,X         CLEAR OUT REST
D7E7 6F03             (     flx29fms.asm):00982 [6+1]           CLR     3,X
D7E9 6F04             (     flx29fms.asm):00983 [6+1]           CLR     4,X
D7EB 6F05             (     flx29fms.asm):00984 [6+1]           CLR     5,X
D7ED 2008             (     flx29fms.asm):00985 [3]             BRA     ASNNX8      GO AHEAD
                      (     flx29fms.asm):00986         
D7EF 10AE04           (     flx29fms.asm):00987 [6+1]   ASNNX7  LDY     4,X         GET SEC COUNT
D7F2 313F             (     flx29fms.asm):00988 [4+1]           LEAY    -1,Y        DEC BY 1
D7F4 10AF04           (     flx29fms.asm):00989 [6+1]           STY     4,X         SAVE RESULT
                      (     flx29fms.asm):00990         
D7F7 4F               (     flx29fms.asm):00991 [2]     ASNNX8  CLRA                CLEAR REGISTER
D7F8 BED40B           (     flx29fms.asm):00992 [6]             LDX     FCBSTR      SET POINTER
D7FB 6C8821           (     flx29fms.asm):00993 [6+1]           INC     FRN+1,X     INC LRN
D7FE 2603             (     flx29fms.asm):00994 [3]             BNE     ASNN85
D800 6C8820           (     flx29fms.asm):00995 [6+1]           INC     FRN,X
                      (     flx29fms.asm):00996         
D803 5F               (     flx29fms.asm):00997 [2]     ASNN85  CLRB                GET SECTOR LENGTH \\\\
D804 A78840           (     flx29fms.asm):00998 [4+1]   ASNNX9  STA     FSB,X       CLEAR LOCATION
D807 3001             (     flx29fms.asm):00999 [4+1]           LEAX    1,X         BUMP POINTER
D809 5A               (     flx29fms.asm):01000 [2]             DECB                DEC THE COUNTER
D80A 26F8             (     flx29fms.asm):01001 [3]             BNE     ASNNX9      REPEAT?
                      (     flx29fms.asm):01002         
D80C BED40B           (     flx29fms.asm):01003 [6]             LDX     FCBSTR      GET FCB PNTR
D80F EC8820           (     flx29fms.asm):01004 [5+1]           LDD     FRN,X       GET LRN
D812 ED8842           (     flx29fms.asm):01005 [5+1]           STD     FSB+2,X     SAVE IN DATA
D815 1CFE             (     flx29fms.asm):01006 [3]             ANDCC   #$FE        CLC CLEAR ERRORS
D817 39               (     flx29fms.asm):01007 [5]             RTS
                      (     flx29fms.asm):01008         
                      (     flx29fms.asm):01009         * OPN - SIR, DIR
                      (     flx29fms.asm):01010         *
                      (     flx29fms.asm):01011         * OPNIR OPENS EITHER THE SYSTEM IR
                      (     flx29fms.asm):01012         * OR THE DIRECTORY IR, DEPENDING ON
                      (     flx29fms.asm):01013         * THE ENTRY POINT.
                      (     flx29fms.asm):01014         *
                      (     flx29fms.asm):01015         *   ENTRY: NONE
                      (     flx29fms.asm):01016         *   EXIT:  B & X DESTROYED
                      (     flx29fms.asm):01017         
D818 5F               (     flx29fms.asm):01018 [2]     OPNSIR  CLRB                SET TRACK 0
D819 3404             (     flx29fms.asm):01019 [5+1]           PSHS    B
D81B C603             (     flx29fms.asm):01020 [2]             LDB     #ISEC       GET SECTOR
D81D 200E             (     flx29fms.asm):01021 [3]             BRA     OPNIR
                      (     flx29fms.asm):01022         
                      (     flx29fms.asm):01023         * ------- No Path to this code
                      (     flx29fms.asm):01024         
D81F BED415           (     flx29fms.asm):01025 [6]     OPNCUD  LDX     CUD         GET CUD
D822 BFD413           (     flx29fms.asm):01026 [6]             STX     CLD         SAVE AS LOOKUP
                      (     flx29fms.asm):01027         
                      (     flx29fms.asm):01028         * -------
                      (     flx29fms.asm):01029         
D825 F6D413           (     flx29fms.asm):01030 [5]     OPNCLD  LDB     CLD         GET TRACK
D828 3404             (     flx29fms.asm):01031 [5+1]           PSHS    B           SAVE IT
D82A F6D414           (     flx29fms.asm):01032 [5]             LDB     CLD+1       GET SECTOR
                      (     flx29fms.asm):01033         
     D825             (     flx29fms.asm):01034         OPNDIR  EQU     OPNCLD
                      (     flx29fms.asm):01035         
D82D BED40B           (     flx29fms.asm):01036 [6]     OPNIR   LDX     FCBSTR      SET FCB POINTER
D830 E78841           (     flx29fms.asm):01037 [4+1]           STB     FSB+1,X     SAVE SECTOR
D833 3504             (     flx29fms.asm):01038 [5+1]           PULS    B           GET TRACK
D835 E78840           (     flx29fms.asm):01039 [4+1]           STB     FSB,X       SET SECTOR PNTR
D838 7FD418           (     flx29fms.asm):01040 [7]             CLR     BKLN        CLEAR BACK LINK
D83B 5F               (     flx29fms.asm):01041 [2]             CLRB                GET SECTOR LENGTH \\\\
D83C E78822           (     flx29fms.asm):01042 [4+1]           STB     FDI,X       SAVE IT
D83F 39               (     flx29fms.asm):01043 [5]             RTS
                      (     flx29fms.asm):01044         
                      (     flx29fms.asm):01045         * GETIR
                      (     flx29fms.asm):01046         *
                      (     flx29fms.asm):01047         * GETIR GETS THE NEXT INFORMATION
                      (     flx29fms.asm):01048         * RECORD (IR) FROM THE FSB.
                      (     flx29fms.asm):01049         *
                      (     flx29fms.asm):01050         *   ENTRY: X = FCB
                      (     flx29fms.asm):01051         *   EXIT:  CS IF ERROR
                      (     flx29fms.asm):01052         
D840 BED40B           (     flx29fms.asm):01053 [6]     GETIR   LDX     FCBSTR      SET FCB POINTER
D843 E68822           (     flx29fms.asm):01054 [4+1]           LDB     FDI,X       GET DATA INDEX
D846 261E             (     flx29fms.asm):01055 [3]             BNE     GETIR2      NEXT SECTOR?
                      (     flx29fms.asm):01056         
D848 BDD614           (     flx29fms.asm):01057 [8]             JSR     RDNEXT      GET NEXT SECTOR
D84B 2531             (     flx29fms.asm):01058 [3]             BCS     GETIR8      ERROR?
                      (     flx29fms.asm):01059         
D84D BED40B           (     flx29fms.asm):01060 [6]             LDX     FCBSTR      GET FCB POINTER
D850 7DD418           (     flx29fms.asm):01061 [7]             TST     BKLN        TEST BACK LINK
D853 2606             (     flx29fms.asm):01062 [3]             BNE     GETIR1      IS IT SET?
                      (     flx29fms.asm):01063         
D855 CC0005           (     flx29fms.asm):01064 [3]             LDD     #$0005 < OLD Code
                      (     flx29fms.asm):01065         *       LDD     FSB+4,X    GET NEW BL  <- CORRECTED
D858 FDD418           (     flx29fms.asm):01066 [6]             STD     BKLN        SAVE IT
                      (     flx29fms.asm):01067         
D85B 8610             (     flx29fms.asm):01068 [2]     GETIR1  LDA     #IRS        SET START INDEX
D85D A78822           (     flx29fms.asm):01069 [4+1]           STA     FDI,X
D860 EC881E           (     flx29fms.asm):01070 [5+1]           LDD     FCS,X       GET CURRENT SEC ADR
D863 ED882F           (     flx29fms.asm):01071 [5+1]           STD     FCD,X       SET CURRENT IR
                      (     flx29fms.asm):01072         
D866 A68822           (     flx29fms.asm):01073 [4+1]   GETIR2  LDA     FDI,X       GET CURRENT INDEX
D869 A78831           (     flx29fms.asm):01074 [4+1]           STA     FCD+2,X     SAVE IT
D86C C618             (     flx29fms.asm):01075 [2]             LDB     #IRL        SET LENGTH
                      (     flx29fms.asm):01076         
D86E 3414             (     flx29fms.asm):01077 [5+3]   GETIR4  PSHS    B,X         SAVE VALUES
D870 BDD5FD           (     flx29fms.asm):01078 [8]             JSR     RDSEQ       READ NEXT CHAR
D873 3514             (     flx29fms.asm):01079 [5+3]           PULS    B,X         RESTORE VALUES
D875 A704             (     flx29fms.asm):01080 [4+1]           STA     FFN,X       PUT THE CHAR
D877 3001             (     flx29fms.asm):01081 [4+1]           LEAX    1,X         BUMP THE POINTER
D879 5A               (     flx29fms.asm):01082 [2]             DECB                DEC THE COUNT
D87A 26F2             (     flx29fms.asm):01083 [3]             BNE     GETIR4      FINISHED?
                      (     flx29fms.asm):01084         *       CLRB                CLEAR ERRORS
D87C 1CFE             (     flx29fms.asm):01085 [3]             ANDCC   #$FE        CLC CLEAR ERROR
D87E 39               (     flx29fms.asm):01086 [5]     GETIR8  RTS
                      (     flx29fms.asm):01087         
                      (     flx29fms.asm):01088         * PUTIR
                      (     flx29fms.asm):01089         *
                      (     flx29fms.asm):01090         * PUTIR PUTS THE IR INTO THE FSB.
                      (     flx29fms.asm):01091         *
                      (     flx29fms.asm):01092         *   ENTRY: NONE
                      (     flx29fms.asm):01093         *   EXIT:  CS IF ERROR
                      (     flx29fms.asm):01094         
D87F BED40B           (     flx29fms.asm):01095 [6]     PUTIR   LDX     FCBSTR      SET FCB POINTER
D882 A68831           (     flx29fms.asm):01096 [4+1]           LDA     FCD+2,X     GET INDEX
D885 A78822           (     flx29fms.asm):01097 [4+1]           STA     FDI,X       SET IT
D888 C618             (     flx29fms.asm):01098 [2]             LDB     #IRL        SET LENGTH COUNT
                      (     flx29fms.asm):01099         
D88A 3414             (     flx29fms.asm):01100 [5+3]   PUTIR2  PSHS    B,X         SAVE POINTERS
D88C A604             (     flx29fms.asm):01101 [4+1]           LDA     FFN,X       GET THE CHAR
D88E BDD71C           (     flx29fms.asm):01102 [8]             JSR     WTSEQ       GO WRITE CHAR
D891 3514             (     flx29fms.asm):01103 [5+3]           PULS    B,X         RESTORE POINTERS
D893 3001             (     flx29fms.asm):01104 [4+1]           LEAX    1,X         BUMP THE POINTER
D895 5A               (     flx29fms.asm):01105 [2]             DECB                DEC THE COUNT
D896 26F2             (     flx29fms.asm):01106 [3]             BNE     PUTIR2      REPEAT?
                      (     flx29fms.asm):01107         
D898 7ED6A7           (     flx29fms.asm):01108 [4]             JMP     WRITSS      GO WRITE SECTOR
                      (     flx29fms.asm):01109         
                      (     flx29fms.asm):01110         * FNDNAM
                      (     flx29fms.asm):01111         *
                      (     flx29fms.asm):01112         * FNDNAM TRIES TO FIND THE NAME IN
                      (     flx29fms.asm):01113         * FFN IN THE DIRECTORY.
                      (     flx29fms.asm):01114         *
                      (     flx29fms.asm):01115         *   ENTRY: NAME IN FFN
                      (     flx29fms.asm):01116         *   EXIT:  EQ IF FOUND
                      (     flx29fms.asm):01117         *          CS IF ERROR ( IN B )
                      (     flx29fms.asm):01118         *          REGISTERS CHANGED
                      (     flx29fms.asm):01119         
D89B BED40B           (     flx29fms.asm):01120 [6]     FNDNAM  LDX     FCBSTR      GET FCB
D89E A603             (     flx29fms.asm):01121 [4+1]           LDA     FDN,X       GET DRIVE NUM
D8A0 A78823           (     flx29fms.asm):01122 [4+1]           STA     FRI,X       SAVE IT IN TEMP
D8A3 B6D417           (     flx29fms.asm):01123 [5]             LDA     DIRDN       GET DIR DRIVE NUM
D8A6 7DD41A           (     flx29fms.asm):01124 [7]             TST     SINDIR      SINGLE DIR ?
D8A9 2631             (     flx29fms.asm):01125 [3]             BNE     FNDNA1
                      (     flx29fms.asm):01126         
D8AB A703             (     flx29fms.asm):01127 [4+1]           STA     FDN,X       SET NEW DRIVE NUM
D8AD BED415           (     flx29fms.asm):01128 [6]             LDX     CUD         GET DIR POINTER
D8B0 BFD413           (     flx29fms.asm):01129 [6]             STX     CLD         SET CLD
                      (     flx29fms.asm):01130         
D8B3 8C0005           (     flx29fms.asm):01131 [4]     FNDN04  CMPX    #MAIND      IS IT MAIN?
D8B6 270C             (     flx29fms.asm):01132 [3]             BEQ     FNDN06
D8B8 8D22             (     flx29fms.asm):01133 [7]             BSR     FNDNA1      SEARCH DIR
D8BA 2337             (     flx29fms.asm):01134 [3]             BLS     FNDNA3      FIND OR ERROR?
D8BC BED418           (     flx29fms.asm):01135 [6]             LDX     BKLN        GET BACK LINK
D8BF BFD413           (     flx29fms.asm):01136 [6]             STX     CLD         SET CLD
D8C2 20EF             (     flx29fms.asm):01137 [3]             BRA     FNDN04      REPEAT
                      (     flx29fms.asm):01138         
D8C4 BED40B           (     flx29fms.asm):01139 [6]     FNDN06  LDX     FCBSTR      SET POINTER
D8C7 A68823           (     flx29fms.asm):01140 [4+1]           LDA     FRI,X       RESTORE DN
D8CA A703             (     flx29fms.asm):01141 [4+1]           STA     FDN,X
D8CC 2A0E             (     flx29fms.asm):01142 [3]             BPL     FNDNA1      DRIVE SPECIFIC?
                      (     flx29fms.asm):01143         
D8CE BDDDD5           (     flx29fms.asm):01144 [8]     FNDN08  JSR     NXTRDY      GET NEXT RDY DRV
D8D1 2536             (     flx29fms.asm):01145 [3]             BCS     FNDNA9      ERROR?
D8D3 8D07             (     flx29fms.asm):01146 [7]             BSR     FNDNA1      DO SEARCH
D8D5 231C             (     flx29fms.asm):01147 [3]             BLS     FNDNA3      FIND OR ERROR?
D8D7 BDDDC5           (     flx29fms.asm):01148 [8]             JSR     RSTNAM      RESTORE NAME
D8DA 20F2             (     flx29fms.asm):01149 [3]             BRA     FNDN08
                      (     flx29fms.asm):01150         
D8DC BED40B           (     flx29fms.asm):01151 [6]     FNDNA1  LDX     FCBSTR      SET POINTER
D8DF 7FD41A           (     flx29fms.asm):01152 [7]             CLR     SINDIR      CLEAR MODE
D8E2 BDD54D           (     flx29fms.asm):01153 [8]             JSR     COPNAM      COPY NAME TO FWB
D8E5 BDD825           (     flx29fms.asm):01154 [8]             JSR     OPNDIR      OPEN DIRECTORY
                      (     flx29fms.asm):01155         
D8E8 BDD840           (     flx29fms.asm):01156 [8]     FNDNA2  JSR     GETIR       GET RECORD
D8EB 2407             (     flx29fms.asm):01157 [3]             BCC     FNDNA4      ERROR?
D8ED C108             (     flx29fms.asm):01158 [2]             CMPB    #EFER       END OF FILE?
D8EF 2718             (     flx29fms.asm):01159 [3]             BEQ     FNDNA9
D8F1 1A01             (     flx29fms.asm):01160 [3]             ORCC    #1          SEC SET ERROR
D8F3 39               (     flx29fms.asm):01161 [5]     FNDNA3  RTS                 ERROR RETURN
                      (     flx29fms.asm):01162         
D8F4 BED40B           (     flx29fms.asm):01163 [6]     FNDNA4  LDX     FCBSTR      POINT TO FCB
D8F7 A604             (     flx29fms.asm):01164 [4+1]           LDA     FFN,X       GET CHAR
D8F9 270C             (     flx29fms.asm):01165 [3]             BEQ     FNDNA8      NO MORE?
D8FB 2A02             (     flx29fms.asm):01166 [3]             BPL     FNDNA6      DELETED NAME?
D8FD 8D0F             (     flx29fms.asm):01167 [7]             BSR     SETFD       SET DELETED
                      (     flx29fms.asm):01168         
D8FF BDD55D           (     flx29fms.asm):01169 [8]     FNDNA6  JSR     CMPNAM      COMPARE NAME
D902 26E4             (     flx29fms.asm):01170 [3]             BNE     FNDNA2      EQUAL?
D904 1CFE             (     flx29fms.asm):01171 [3]             ANDCC   #$FE        CLC CLEAR ERRORS
D906 39               (     flx29fms.asm):01172 [5]             RTS
                      (     flx29fms.asm):01173         
D907 8D05             (     flx29fms.asm):01174 [7]     FNDNA8  BSR     SETFD
D909 1CFB             (     flx29fms.asm):01175 [3]     FNDNA9  ANDCC   #$FB        SHOW NO FIND
D90B 1CFE             (     flx29fms.asm):01176 [3]             ANDCC   #$FE        CLC CLEAR ERRORS
D90D 39               (     flx29fms.asm):01177 [5]             RTS
                      (     flx29fms.asm):01178         
D90E A68833           (     flx29fms.asm):01179 [4+1]   SETFD   LDA     FFD+1,X     FIRST DELETED?
D911 260C             (     flx29fms.asm):01180 [3]             BNE     SETFD2
D913 EC882F           (     flx29fms.asm):01181 [5+1]           LDD     FCD,X       GET CURRENT ADR
D916 ED8832           (     flx29fms.asm):01182 [5+1]           STD     FFD,X       SET FIRST DELETED
D919 A68831           (     flx29fms.asm):01183 [4+1]           LDA     FCD+2,X     GET INDEX
D91C A78834           (     flx29fms.asm):01184 [4+1]           STA     FFD+2,X     SAVE IT
D91F 39               (     flx29fms.asm):01185 [5]     SETFD2  RTS
                      (     flx29fms.asm):01186         
                      (     flx29fms.asm):01187         * GETAVL
                      (     flx29fms.asm):01188         *
                      (     flx29fms.asm):01189         * GETAVL SETS THE SECTOR MAP POINTERS
                      (     flx29fms.asm):01190         * IF THEY HAVE NOT BEEN SET.
                      (     flx29fms.asm):01191         *
                      (     flx29fms.asm):01192         *   ENTRY: NONE
                      (     flx29fms.asm):01193         *   EXIT:  CS SET IF ERROR
                      (     flx29fms.asm):01194         *          REGISTERS CHANGED
                      (     flx29fms.asm):01195         
D920 BDD78F           (     flx29fms.asm):01196 [8]     GETAVL  JSR     FSECMP      FIND MAP
D923 2617             (     flx29fms.asm):01197 [3]             BNE     GETAV3      SET YET?
D925 8D18             (     flx29fms.asm):01198 [7]             BSR     GETDIS      READ IN DIS
D927 2515             (     flx29fms.asm):01199 [3]             BCS     GETAV4      ERROR?
                      (     flx29fms.asm):01200         
D929 C606             (     flx29fms.asm):01201 [2]             LDB     #6          SET COUNTER
D92B 10BED40B         (     flx29fms.asm):01202 [7]             LDY     FCBSTR      GET FCB
D92F BED41B           (     flx29fms.asm):01203 [6]             LDX     AVLPNT      POINT TO MAP
                      (     flx29fms.asm):01204         
D932 A6A85D           (     flx29fms.asm):01205 [4+1]   GETAV2  LDA     FSB+FSA+IRS-4,Y
D935 3121             (     flx29fms.asm):01206 [4+1]           LEAY    1,Y
D937 A780             (     flx29fms.asm):01207 [4+2]           STA     ,X+
D939 5A               (     flx29fms.asm):01208 [2]             DECB                DEC THE COUNT
D93A 26F6             (     flx29fms.asm):01209 [3]             BNE     GETAV2      FINISHED?
                      (     flx29fms.asm):01210         
D93C 1CFE             (     flx29fms.asm):01211 [3]     GETAV3  ANDCC   #$FE        CLC CLEAR ERRORS
D93E 39               (     flx29fms.asm):01212 [5]     GETAV4  RTS
                      (     flx29fms.asm):01213         
                      (     flx29fms.asm):01214         * GETDIS
                      (     flx29fms.asm):01215         *
                      (     flx29fms.asm):01216         * GETDIS READS IN THE DIS SECTOR.
                      (     flx29fms.asm):01217         *
                      (     flx29fms.asm):01218         *   ENTRY: NONE
                      (     flx29fms.asm):01219         *   EXIT:  CS IF ERROR
                      (     flx29fms.asm):01220         *          REGISTERS CHANGED
                      (     flx29fms.asm):01221         
D93F BDD818           (     flx29fms.asm):01222 [8]     GETDIS  JSR     OPNSIR      OPEN THE DIS
D942 BDD614           (     flx29fms.asm):01223 [8]             JSR     RDNEXT      READ NEXT BLOCK
D945 2508             (     flx29fms.asm):01224 [3]             BCS     GETDI2      ERROR?
                      (     flx29fms.asm):01225         
D947 BED40B           (     flx29fms.asm):01226 [6]             LDX     FCBSTR      SET POINTER
D94A C610             (     flx29fms.asm):01227 [2]             LDB     #IRS        SET START POINT
D94C E78822           (     flx29fms.asm):01228 [4+1]           STB     FDI,X       SET INDEX
D94F 39               (     flx29fms.asm):01229 [5]     GETDI2  RTS
                      (     flx29fms.asm):01230         
                      (     flx29fms.asm):01231         * PUTAVL
                      (     flx29fms.asm):01232         *
                      (     flx29fms.asm):01233         * PUTAVL UPDATES THE DIS SECTOR.
                      (     flx29fms.asm):01234         *
                      (     flx29fms.asm):01235         *   ENTRY: NONE
                      (     flx29fms.asm):01236         *   EXIT:  CS IF ERROR
                      (     flx29fms.asm):01237         *          REGISTERS CHANGED
                      (     flx29fms.asm):01238         
D950 BDD78F           (     flx29fms.asm):01239 [8]     PUTAVL  JSR     FSECMP      FIND SECTOR MAP
D953 8DEA             (     flx29fms.asm):01240 [7]             BSR     GETDIS      GO GET DIS
D955 25F8             (     flx29fms.asm):01241 [3]             BCS     GETDI2      ERROR?
D957 C606             (     flx29fms.asm):01242 [2]             LDB     #6          SET UP COUNTER
D959 10BED40B         (     flx29fms.asm):01243 [7]             LDY     FCBSTR      GET FCB POINTER
D95D BED41B           (     flx29fms.asm):01244 [6]             LDX     AVLPNT      POINT TO MAP
                      (     flx29fms.asm):01245         
D960 A680             (     flx29fms.asm):01246 [4+2]   PUTAV2  LDA     ,X+
D962 A7A85D           (     flx29fms.asm):01247 [4+1]           STA     FSB+FSA+IRS-4,Y
D965 3121             (     flx29fms.asm):01248 [4+1]           LEAY    1,Y
D967 5A               (     flx29fms.asm):01249 [2]             DECB                DEC THE COUNT
D968 26F6             (     flx29fms.asm):01250 [3]             BNE     PUTAV2      FINISHED?
                      (     flx29fms.asm):01251         
D96A BDD6A7           (     flx29fms.asm):01252 [8]             JSR     WRITSS      WRITE SECTOR
D96D 24E0             (     flx29fms.asm):01253 [3]             BCC     GETDI2      ERROR?
D96F 7EDBD8           (     flx29fms.asm):01254 [4]             JMP     WRTERR      REPORT ERROR
                      (     flx29fms.asm):01255         
                      (     flx29fms.asm):01256         * WRTDIR
                      (     flx29fms.asm):01257         *
                      (     flx29fms.asm):01258         * WRTDIR UPDATES THE DISK DIRECTORY.
                      (     flx29fms.asm):01259         *
                      (     flx29fms.asm):01260         *   ENTRY: NONE
                      (     flx29fms.asm):01261         *   EXIT:  CS IF ERROR
                      (     flx29fms.asm):01262         
D972 BED40B           (     flx29fms.asm):01263 [6]     WRTDIR  LDX     FCBSTR      POINT TO FCB
D975 8602             (     flx29fms.asm):01264 [2]             LDA     #2          SET FOR WRITE
D977 A702             (     flx29fms.asm):01265 [4+1]           STA     FAS,X
D979 EC882F           (     flx29fms.asm):01266 [5+1]           LDD     FCD,X       GET CURRENT DIR
D97C ED881E           (     flx29fms.asm):01267 [5+1]           STD     FCS,X       SET CURRENT SECTOR
D97F BDD649           (     flx29fms.asm):01268 [8]             JSR     READSS      READ IN DIR
D982 2508             (     flx29fms.asm):01269 [3]             BCS     WRTDI2      ERROR?
D984 BDD87F           (     flx29fms.asm):01270 [8]             JSR     PUTIR       GO WRITE DIR
D987 2405             (     flx29fms.asm):01271 [3]             BCC     WRTDI4
D989 7EDBD8           (     flx29fms.asm):01272 [4]             JMP     WRTERR      CHECK FOR WP ERR
                      (     flx29fms.asm):01273         
D98C C60A             (     flx29fms.asm):01274 [2]     WRTDI2  LDB     #WTER       SET ERROR
D98E 39               (     flx29fms.asm):01275 [5]     WRTDI4  RTS                 ERROR RETURN
                      (     flx29fms.asm):01276         
                      (     flx29fms.asm):01277         * OPNRD
                      (     flx29fms.asm):01278         *
                      (     flx29fms.asm):01279         * OPNRD IS THE HIGH LEVEL SYSTEM
                      (     flx29fms.asm):01280         * ROUTINE WHICH OPENS A FILE FOR
                      (     flx29fms.asm):01281         * A READ OPERATION.
                      (     flx29fms.asm):01282         *
                      (     flx29fms.asm):01283         *   ENTRY: NONE
                      (     flx29fms.asm):01284         *   EXIT:  CS IF ERROR (IN B)
                      (     flx29fms.asm):01285         *          REGISTERS CHANGED
                      (     flx29fms.asm):01286         
D98F BDD4FE           (     flx29fms.asm):01287 [8]     OPNRD   JSR     SETFCB      SET FCB POINTER
D992 253D             (     flx29fms.asm):01288 [3]             BCS     OPNRD2      ERROR?
D994 BDD89B           (     flx29fms.asm):01289 [8]             JSR     FNDNAM      LOOK UP NAME
D997 2538             (     flx29fms.asm):01290 [3]             BCS     OPNRD2      ERRORS?
                      (     flx29fms.asm):01291         
D999 263B             (     flx29fms.asm):01292 [3]             BNE     LD9D6       WAS IT FOUND?
                      (     flx29fms.asm):01293         
D99B BED40B           (     flx29fms.asm):01294 [6]             LDX     FCBSTR      POINT TO FCB
D99E 7DD41A           (     flx29fms.asm):01295 [7]             TST     SINDIR      SINGLE DIR?
D9A1 2706             (     flx29fms.asm):01296 [3]             BEQ     OPNRD1
D9A3 A60F             (     flx29fms.asm):01297 [4+1]           LDA     FID,X       CHECK RP BIT
D9A5 8520             (     flx29fms.asm):01298 [2]             BITA    #$20        IS IT SET?
D9A7 2629             (     flx29fms.asm):01299 [3]             BNE     OPNRD3      REPORT ERROR
                      (     flx29fms.asm):01300         
D9A9 BDDCD8           (     flx29fms.asm):01301 [8]     OPNRD1  JSR     SETMAX      SET MAX SEC
D9AC 252A             (     flx29fms.asm):01302 [3]             BCS     OPNERR      ERROR?
D9AE EC8811           (     flx29fms.asm):01303 [5+1]           LDD     FSA,X       GET ADDRESS
D9B1 ED8840           (     flx29fms.asm):01304 [5+1]           STD     FSB,X       SET FRWD LINK
D9B4 BDDA8D           (     flx29fms.asm):01305 [8]             JSR     SETST       SET STATUS
D9B7 E68817           (     flx29fms.asm):01306 [4+1]           LDB     FMP,X       CHECK RANDOM
D9BA 2713             (     flx29fms.asm):01307 [3]             BEQ     OPNR15
                      (     flx29fms.asm):01308         
D9BC 3404             (     flx29fms.asm):01309 [5+1]   OPNR12  PSHS    B           SAVE COUNT
D9BE BDD614           (     flx29fms.asm):01310 [8]             JSR     RDNEXT      GET NEXT SECTOR
D9C1 3504             (     flx29fms.asm):01311 [5+1]           PULS    B           RESTORE COUNT
D9C3 250C             (     flx29fms.asm):01312 [3]             BCS     OPNRD2      ERROR?
                      (     flx29fms.asm):01313         
D9C5 5A               (     flx29fms.asm):01314 [2]             DECB                DEC THE COUNT
D9C6 26F4             (     flx29fms.asm):01315 [3]             BNE     OPNR12
                      (     flx29fms.asm):01316         
D9C8 BED40B           (     flx29fms.asm):01317 [6]             LDX     FCBSTR      SET FCB PNTR
D9CB 5F               (     flx29fms.asm):01318 [2]             CLRB                GET SECTOR LENGTH \\\\
D9CC E78822           (     flx29fms.asm):01319 [4+1]           STB     FDI,X
                      (     flx29fms.asm):01320         
D9CF 1CFE             (     flx29fms.asm):01321 [3]     OPNR15  ANDCC   #$FE        CLC CLEAR ERRORS
D9D1 39               (     flx29fms.asm):01322 [5]     OPNRD2  RTS
                      (     flx29fms.asm):01323         
D9D2 C611             (     flx29fms.asm):01324 [2]     OPNRD3  LDB     #ADER       READ ACC DENIED
D9D4 2002             (     flx29fms.asm):01325 [3]             BRA     OPNERR
                      (     flx29fms.asm):01326         
D9D6 C604             (     flx29fms.asm):01327 [2]     LD9D6   LDB     #NFER       FILE NOT FOUND
                      (     flx29fms.asm):01328         
                      (     flx29fms.asm):01329         * OPEN ERROR
                      (     flx29fms.asm):01330         
D9D8 3404             (     flx29fms.asm):01331 [5+1]   OPNERR  PSHS    B           SAVE ERROR
D9DA BDD510           (     flx29fms.asm):01332 [8]             JSR     REMFCB      REMOVE FCB
D9DD 3504             (     flx29fms.asm):01333 [5+1]           PULS    B
D9DF 1A01             (     flx29fms.asm):01334 [3]             ORCC    #1          SEC  SET ERROR
D9E1 39               (     flx29fms.asm):01335 [5]             RTS
                      (     flx29fms.asm):01336         
                      (     flx29fms.asm):01337         * OPNWT
                      (     flx29fms.asm):01338         *
                      (     flx29fms.asm):01339         * OPNWT OPENS A FILE FOR WRITE.
                      (     flx29fms.asm):01340         *
                      (     flx29fms.asm):01341         *   ENTRY: NONE
                      (     flx29fms.asm):01342         *   EXIT:  CS IF ERROR (IN B)
                      (     flx29fms.asm):01343         *          REGISTERS CHANGED
                      (     flx29fms.asm):01344         
D9E2 BED40B           (     flx29fms.asm):01345 [6]     OPNWT   LDX     FCBSTR      SET POINTER
D9E5 6D03             (     flx29fms.asm):01346 [6+1]           TST     FDN,X       CHECK FOR ALL DRIVES
D9E7 2A08             (     flx29fms.asm):01347 [3]             BPL     OPNWT3
D9E9 BDDDD5           (     flx29fms.asm):01348 [8]             JSR     NXTRDY      FIND READY
D9EC 2403             (     flx29fms.asm):01349 [3]             BCC     OPNWT3      FOUND ONE
D9EE C610             (     flx29fms.asm):01350 [2]             LDB     #NRER       NONE READY
D9F0 39               (     flx29fms.asm):01351 [5]             RTS
                      (     flx29fms.asm):01352         
D9F1 BDD4FE           (     flx29fms.asm):01353 [8]     OPNWT3  JSR     SETFCB      SET FCB LINK
D9F4 25E2             (     flx29fms.asm):01354 [3]             BCS     OPNERR      ERROR?
D9F6 BDD53B           (     flx29fms.asm):01355 [8]             JSR     CLRFCB      CLEAR OUT FCB
D9F9 BDD920           (     flx29fms.asm):01356 [8]             JSR     GETAVL      SETUP SECTOR MAP
D9FC 25DA             (     flx29fms.asm):01357 [3]             BCS     OPNERR      ERROR?
D9FE BDD89B           (     flx29fms.asm):01358 [8]             JSR     FNDNAM      GO LOOK FOR NAME
DA01 25D5             (     flx29fms.asm):01359 [3]             BCS     OPNERR      ERROR?
DA03 2604             (     flx29fms.asm):01360 [3]             BNE     OPNWT4      FIND?
DA05 C603             (     flx29fms.asm):01361 [2]             LDB     #FEER       FOUND - ERROR
DA07 20CF             (     flx29fms.asm):01362 [3]             BRA     OPNERR
                      (     flx29fms.asm):01363         
DA09 BDDCD8           (     flx29fms.asm):01364 [8]     OPNWT4  JSR     SETMAX      SET MAX SEC
DA0C 25CA             (     flx29fms.asm):01365 [3]             BCS     OPNERR      ERROR?
DA0E BED40B           (     flx29fms.asm):01366 [6]             LDX     FCBSTR      POINT TO FCB
DA11 C60A             (     flx29fms.asm):01367 [2]             LDB     #10         SET COUNT
DA13 6F0F             (     flx29fms.asm):01368 [6+1]   OPNWT5  CLR     FID,X       CLEAR BLOCK
DA15 3001             (     flx29fms.asm):01369 [4+1]           LEAX    1,X
DA17 5A               (     flx29fms.asm):01370 [2]             DECB                DEC THE COUNT
DA18 26F9             (     flx29fms.asm):01371 [3]             BNE     OPNWT5
                      (     flx29fms.asm):01372         
DA1A BED40B           (     flx29fms.asm):01373 [6]             LDX     FCBSTR
DA1D EC8832           (     flx29fms.asm):01374 [5+1]           LDD     FFD,X       GET FIRST DELETED
DA20 2734             (     flx29fms.asm):01375 [3]             BEQ     OPNWT8      EOF ER?
DA22 ED882F           (     flx29fms.asm):01376 [5+1]           STD     FCD,X       SET CURRENT DIR
DA25 A68834           (     flx29fms.asm):01377 [4+1]           LDA     FFD+2,X     GET INDEX
DA28 A78831           (     flx29fms.asm):01378 [4+1]           STA     FCD+2,X     SAVE IT
DA2B FCCC0E           (     flx29fms.asm):01379 [6]             LDD     DATE        GET DATE
DA2E ED8819           (     flx29fms.asm):01380 [5+1]           STD     FDT,X       SET DATE
DA31 B6CC10           (     flx29fms.asm):01381 [5]             LDA     DATE+2
DA34 A7881B           (     flx29fms.asm):01382 [4+1]           STA     FDT+2,X
                      (     flx29fms.asm):01383         
                      (     flx29fms.asm):01384         *       -- Not in UniFLEX version
                      (     flx29fms.asm):01385         
DA37 A603             (     flx29fms.asm):01386 [4+1]           LDA     FDN,X       GET DRIVE
DA39 8ED436           (     flx29fms.asm):01387 [3]             LDX     #DRVINFO    GET TABLE POINTER
DA3C A686             (     flx29fms.asm):01388 [4+1]           LDA     A,X         GET DRIVE INFO
DA3E BED40B           (     flx29fms.asm):01389 [6]             LDX     FCBSTR      POINT TO FCB
DA41 A78818           (     flx29fms.asm):01390 [4+1]           STA     24,X
                      (     flx29fms.asm):01391         
                      (     flx29fms.asm):01392         *       --
                      (     flx29fms.asm):01393         
DA44 BDDDC5           (     flx29fms.asm):01394 [8]             JSR     RSTNAM      RESTORE NAME
DA47 BDD972           (     flx29fms.asm):01395 [8]             JSR     WRTDIR      SET DIRECTORY
DA4A 258C             (     flx29fms.asm):01396 [3]             BCS     OPNERR      ERROR?
DA4C 8D3F             (     flx29fms.asm):01397 [7]             BSR     SETST       SET STATUS
DA4E 8604             (     flx29fms.asm):01398 [2]             LDA     #RS         SET DATA POINTER
DA50 A78822           (     flx29fms.asm):01399 [4+1]           STA     FDI,X
DA53 1CFE             (     flx29fms.asm):01400 [3]             ANDCC   #$FE        CLC CLEAR ERRORS
DA55 39               (     flx29fms.asm):01401 [5]             RTS
                      (     flx29fms.asm):01402         
DA56 BED40B           (     flx29fms.asm):01403 [6]     OPNWT8  LDX     FCBSTR      POINT TO FCB
DA59 6F8817           (     flx29fms.asm):01404 [6+1]           CLR     FMP,X       CLEAR FLAG
DA5C 6C8812           (     flx29fms.asm):01405 [6+1]           INC     FSA+1,X     SET FSA NON 0
DA5F EC882F           (     flx29fms.asm):01406 [5+1]           LDD     FCD,X       GET POSITION
DA62 BDD628           (     flx29fms.asm):01407 [8]             JSR     RDNEX2      READ SECTOR
DA65 250D             (     flx29fms.asm):01408 [3]             BCS     OPNW85      ERROR?
                      (     flx29fms.asm):01409         
DA67 BDD77A           (     flx29fms.asm):01410 [8]             JSR     WTNEX1      GO WRITE NEW
DA6A 2508             (     flx29fms.asm):01411 [3]             BCS     OPNW85      ERROR?
                      (     flx29fms.asm):01412         
DA6C BDD6A7           (     flx29fms.asm):01413 [8]             JSR     WRITSS      WRITE NEW SECTOR
DA6F 2406             (     flx29fms.asm):01414 [3]             BCC     OPNWT9      ERROR?
DA71 BDDBD8           (     flx29fms.asm):01415 [8]             JSR     WRTERR      REPORT ERROR
                      (     flx29fms.asm):01416         
DA74 7ED9D8           (     flx29fms.asm):01417 [4]     OPNW85  JMP     OPNERR
                      (     flx29fms.asm):01418         
DA77 BED40B           (     flx29fms.asm):01419 [6]     OPNWT9  LDX     FCBSTR      SET POINTER
DA7A EC881E           (     flx29fms.asm):01420 [5+1]           LDD     FCS,X       GET CURRENT
DA7D ED8832           (     flx29fms.asm):01421 [5+1]           STD     FFD,X       SET FIRST DELETED
DA80 8610             (     flx29fms.asm):01422 [2]             LDA     #IRS        SET INDEX
DA82 A78834           (     flx29fms.asm):01423 [4+1]           STA     FFD+2,X
DA85 BDD950           (     flx29fms.asm):01424 [8]             JSR     PUTAVL      UPDATE AVLS
DA88 25EA             (     flx29fms.asm):01425 [3]             BCS     OPNW85
DA8A 7EDA09           (     flx29fms.asm):01426 [4]             JMP     OPNWT4      FINISH UP
                      (     flx29fms.asm):01427         
                      (     flx29fms.asm):01428         * SETST
                      (     flx29fms.asm):01429         *
                      (     flx29fms.asm):01430         * SETST SETS THE FCB STATUS AFTER
                      (     flx29fms.asm):01431         * AN OPEN FILE COMMAND.
                      (     flx29fms.asm):01432         *
                      (     flx29fms.asm):01433         *   ENTRY: NONE
                      (     flx29fms.asm):01434         *   EXIT:  A & X CHANGED
                      (     flx29fms.asm):01435         
DA8D BED40B           (     flx29fms.asm):01436 [6]     SETST   LDX     FCBSTR      POINT TO FCB
DA90 A684             (     flx29fms.asm):01437 [4+0]           LDA     FFC,X       GET FUNCTION CODE
DA92 A702             (     flx29fms.asm):01438 [4+1]           STA     FAS,X       SET ACTIVITY STATUS
DA94 6F84             (     flx29fms.asm):01439 [6+0]           CLR     FFC,X       CLEAR FUNCTION CODE
DA96 6F883B           (     flx29fms.asm):01440 [6+1]           CLR     FSC,X       CLEAR SPC COMP
DA99 4F               (     flx29fms.asm):01441 [2]             CLRA                GET SECTOR LENGTH \\\\
DA9A A78822           (     flx29fms.asm):01442 [4+1]           STA     FDI,X       SET INDEX
DA9D 39               (     flx29fms.asm):01443 [5]             RTS
                      (     flx29fms.asm):01444         
                      (     flx29fms.asm):01445         * NEXTS
                      (     flx29fms.asm):01446         *
                      (     flx29fms.asm):01447         * NEXTS IS THE SYSTEM ROUTINE TO
                      (     flx29fms.asm):01448         * ADVANCE TO THE NEXT SECTOR.
                      (     flx29fms.asm):01449         *
                      (     flx29fms.asm):01450         *   ENTRY: NONE
                      (     flx29fms.asm):01451         *   EXIT:  ALL CHANGED
                      (     flx29fms.asm):01452         
DA9E 8D28             (     flx29fms.asm):01453 [7]     NEXTS   BSR     DOSTAT      CHECK STATUS
DAA0 250E             (     flx29fms.asm):01454 [3]             BCS     NEXTS4      ERROR?
DAA2 6F00             (     flx29fms.asm):01455 [6+1]           CLR     0,X
DAA4 44               (     flx29fms.asm):01456 [2]             LSRA                READING?
DAA5 1025FB6B         (     flx29fms.asm):01457 [5+?]           LBCS    RDNEXT      READ NEXT
                      (     flx29fms.asm):01458         
DAA9 C604             (     flx29fms.asm):01459 [2]             LDB     #RS         SET START
DAAB E78822           (     flx29fms.asm):01460 [4+1]           STB     FDI,X       SET INDEX
DAAE 1CFE             (     flx29fms.asm):01461 [3]             ANDCC   #$FE        CLC CLEAR ERRORS
DAB0 39               (     flx29fms.asm):01462 [5]     NEXTS4  RTS
                      (     flx29fms.asm):01463         
                      (     flx29fms.asm):01464         * CHKWT
                      (     flx29fms.asm):01465         *
                      (     flx29fms.asm):01466         * CHECK FOR WRITE SECTOR NECESSITY
                      (     flx29fms.asm):01467         *
                      (     flx29fms.asm):01468         *   ENTRY: NONE
                      (     flx29fms.asm):01469         *   EXIT:  CS IF ERROR
                      (     flx29fms.asm):01470         
DAB1 BED40B           (     flx29fms.asm):01471 [6]     CHKWT   LDX     FCBSTR      GET FCB POINTER
DAB4 A602             (     flx29fms.asm):01472 [4+1]           LDA     FAS,X       GET STATUS
DAB6 8183             (     flx29fms.asm):01473 [2]             CMPA    #$83        NEED WRITING?
DAB8 260B             (     flx29fms.asm):01474 [3]             BNE     CHKWT4
                      (     flx29fms.asm):01475         
DABA 8603             (     flx29fms.asm):01476 [2]             LDA     #3          RESET STATUS
DABC A702             (     flx29fms.asm):01477 [4+1]           STA     FAS,X
                      (     flx29fms.asm):01478         
DABE BDD6A7           (     flx29fms.asm):01479 [8]     CHKWT2  JSR     WRITSS      WRITE SECTOR
DAC1 10250113         (     flx29fms.asm):01480 [5+?]           LBCS    WRTERR      REPORT ERROR
                      (     flx29fms.asm):01481         
DAC5 1CFE             (     flx29fms.asm):01482 [3]     CHKWT4  ANDCC   #$FE        CLC CLEAR ERRORS
DAC7 39               (     flx29fms.asm):01483 [5]             RTS
                      (     flx29fms.asm):01484         
                      (     flx29fms.asm):01485         * DOSTAT
                      (     flx29fms.asm):01486         *
                      (     flx29fms.asm):01487         * DOSTAT DOES FILE STATUS CHECKING
                      (     flx29fms.asm):01488         *
                      (     flx29fms.asm):01489         *   ENTRY: NONE
                      (     flx29fms.asm):01490         *   EXIT:  ALL CHANGED
                      (     flx29fms.asm):01491         *          CS IF ERROR
                      (     flx29fms.asm):01492         
DAC8 8DE7             (     flx29fms.asm):01493 [7]     DOSTAT  BSR     CHKWT       CHECK FOR WRITE
DACA 250D             (     flx29fms.asm):01494 [3]             BCS     DOSTA4      ERRORS?
                      (     flx29fms.asm):01495         
DACC BED40B           (     flx29fms.asm):01496 [6]             LDX     FCBSTR      SET POINTER
DACF A602             (     flx29fms.asm):01497 [4+1]           LDA     FAS,X       GET STATUS
DAD1 8103             (     flx29fms.asm):01498 [2]             CMPA    #3          IS IT RW?
DAD3 23F0             (     flx29fms.asm):01499 [3]             BLS     CHKWT4      ERROR?
                      (     flx29fms.asm):01500         
DAD5 C612             (     flx29fms.asm):01501 [2]             LDB     #STER       SET ERROR
DAD7 1A01             (     flx29fms.asm):01502 [3]             ORCC    #1          SEC
DAD9 39               (     flx29fms.asm):01503 [5]     DOSTA4  RTS                 ERROR RETURN
                      (     flx29fms.asm):01504         
                      (     flx29fms.asm):01505         * CLOSE
                      (     flx29fms.asm):01506         *
                      (     flx29fms.asm):01507         * CLOSE A DISK FILE
                      (     flx29fms.asm):01508         *
                      (     flx29fms.asm):01509         *   ENTRY: NONE
                      (     flx29fms.asm):01510         *   EXIT:  ALL CHANGED
                      (     flx29fms.asm):01511         
DADA 8DEC             (     flx29fms.asm):01512 [7]     CLOSE   BSR     DOSTAT      CHECK STATUS
DADC 2531             (     flx29fms.asm):01513 [3]             BCS     CLOSE4      ERROR?
DADE 8102             (     flx29fms.asm):01514 [2]             CMPA    #2          IS IT WRITE?
DAE0 2708             (     flx29fms.asm):01515 [3]             BEQ     CLOSE2
                      (     flx29fms.asm):01516         
DAE2 BED40B           (     flx29fms.asm):01517 [6]     CLOSE1  LDX     FCBSTR      GET FCB
DAE5 6F02             (     flx29fms.asm):01518 [6+1]           CLR     FAS,X       CLEAR STATUS
DAE7 7ED510           (     flx29fms.asm):01519 [4]             JMP     REMFCB      REMOVE FCB
                      (     flx29fms.asm):01520         
DAEA A68812           (     flx29fms.asm):01521 [4+1]   CLOSE2  LDA     FSA+1,X     CHECK IF EMPTY
DAED 2605             (     flx29fms.asm):01522 [3]             BNE     CLOSE3      EMPTY?
DAEF BDDBBE           (     flx29fms.asm):01523 [8]             JSR     DELNAM      DELETE NAME
DAF2 2019             (     flx29fms.asm):01524 [3]             BRA     CLOS35
                      (     flx29fms.asm):01525         
DAF4 8DC8             (     flx29fms.asm):01526 [7]     CLOSE3  BSR     CHKWT2      WRITE SECTOR
DAF6 2517             (     flx29fms.asm):01527 [3]             BCS     CLOSE4      ERROR?
DAF8 BED40B           (     flx29fms.asm):01528 [6]             LDX     FCBSTR      GET POINTER
DAFB 6D8817           (     flx29fms.asm):01529 [6+1]           TST     FMP,X       RANDOM?
DAFE 2705             (     flx29fms.asm):01530 [3]             BEQ     CLOS32
                      (     flx29fms.asm):01531         
DB00 BDDCAF           (     flx29fms.asm):01532 [8]             JSR     WTFSM       WRITE FSM
DB03 250A             (     flx29fms.asm):01533 [3]             BCS     CLOSE4      ERROR?
                      (     flx29fms.asm):01534         
DB05 BDD972           (     flx29fms.asm):01535 [8]     CLOS32  JSR     WRTDIR      WRITE DIRECTORY
DB08 2505             (     flx29fms.asm):01536 [3]             BCS     CLOSE4      ERROR?
                      (     flx29fms.asm):01537         
DB0A BDD950           (     flx29fms.asm):01538 [8]             JSR     PUTAVL      SET AVL MAP
                      (     flx29fms.asm):01539         
DB0D 24D3             (     flx29fms.asm):01540 [3]     CLOS35  BCC     CLOSE1      ERRORS?
DB0F 39               (     flx29fms.asm):01541 [5]     CLOSE4  RTS                 ERROR RETURN
                      (     flx29fms.asm):01542         
                      (     flx29fms.asm):01543         * OPNRW
                      (     flx29fms.asm):01544         *
                      (     flx29fms.asm):01545         * OPNRW OPENS A FILE FOR UPDATE
                      (     flx29fms.asm):01546         *
                      (     flx29fms.asm):01547         *   ENTRY: NONE
                      (     flx29fms.asm):01548         *   EXIT:  CS IF ERROR
                      (     flx29fms.asm):01549         
DB10 BDD98F           (     flx29fms.asm):01550 [8]     OPNRW   JSR     OPNRD       OPEN AS READ
DB13 2528             (     flx29fms.asm):01551 [3]             BCS     WTAPP4      ERROR?
DB15 BDD614           (     flx29fms.asm):01552 [8]             JSR     RDNEXT      READ FIRST SEC
DB18 2523             (     flx29fms.asm):01553 [3]             BCS     WTAPP4      ERRORS?
                      (     flx29fms.asm):01554         
DB1A 8603             (     flx29fms.asm):01555 [2]             LDA     #3          SET RW STATUS
DB1C 2018             (     flx29fms.asm):01556 [3]             BRA     WTAPP2      FINISH UP
                      (     flx29fms.asm):01557         
                      (     flx29fms.asm):01558         * WTAPP
                      (     flx29fms.asm):01559         *
                      (     flx29fms.asm):01560         * WTAPP IS THE SYSTEM OPEN FILE
                      (     flx29fms.asm):01561         * FOR WRITE APPEND. THE FILE MUST
                      (     flx29fms.asm):01562         * EXIST AND NEW DATA IS WRITTEN ON
                      (     flx29fms.asm):01563         * THE END OF THE FILE.
                      (     flx29fms.asm):01564         *
                      (     flx29fms.asm):01565         *   ENTRY: NONE
                      (     flx29fms.asm):01566         *   EXIT:  CS IF ERROR
                      (     flx29fms.asm):01567         
DB1E BDD98F           (     flx29fms.asm):01568 [8]     WTAPP   JSR     OPNRD       OPEN AS READ
DB21 251A             (     flx29fms.asm):01569 [3]             BCS     WTAPP4      ERRORS?
                      (     flx29fms.asm):01570         
DB23 BED40B           (     flx29fms.asm):01571 [6]             LDX     FCBSTR      GET FCB POINTER
DB26 A60F             (     flx29fms.asm):01572 [4+1]           LDA     FID,X       GET ATT BYTE
DB28 8580             (     flx29fms.asm):01573 [2]             BITA    #$80        CHECK WP BIT
DB2A 2612             (     flx29fms.asm):01574 [3]             BNE     WTAPP6
                      (     flx29fms.asm):01575         
DB2C EC8813           (     flx29fms.asm):01576 [5+1]           LDD     FEA,X       GET END ADDRESS
DB2F BDD628           (     flx29fms.asm):01577 [8]             JSR     RDNEX2      READ IN LAST
DB32 2509             (     flx29fms.asm):01578 [3]             BCS     WTAPP4      ERRORS?
                      (     flx29fms.asm):01579         
DB34 8602             (     flx29fms.asm):01580 [2]             LDA     #2          SET WRITE STATUS
                      (     flx29fms.asm):01581         
DB36 BED40B           (     flx29fms.asm):01582 [6]     WTAPP2  LDX     FCBSTR      SET POINTER
DB39 A702             (     flx29fms.asm):01583 [4+1]           STA     FAS,X       SET STATUS
DB3B 1CFE             (     flx29fms.asm):01584 [3]             ANDCC   #$FE        CLC CLEAR ERRORS
DB3D 39               (     flx29fms.asm):01585 [5]     WTAPP4  RTS
                      (     flx29fms.asm):01586         
DB3E C60B             (     flx29fms.asm):01587 [2]     WTAPP6  LDB     #WPER       SET ERROR
DB40 1A01             (     flx29fms.asm):01588 [3]             ORCC    #1          SEC
DB42 39               (     flx29fms.asm):01589 [5]             RTS
                      (     flx29fms.asm):01590         
                      (     flx29fms.asm):01591         * RENAME
                      (     flx29fms.asm):01592         *
                      (     flx29fms.asm):01593         * RENAME IS THE SYSTEM FILE RENAME
                      (     flx29fms.asm):01594         * ROUTINE.  THE NEW NAME MUST BE IN
                      (     flx29fms.asm):01595         * FCB+FLR.
                      (     flx29fms.asm):01596         *
                      (     flx29fms.asm):01597         *   ENTRY: SEE ABOVE
                      (     flx29fms.asm):01598         *   EXIT:  CS IF ERROR
                      (     flx29fms.asm):01599         
DB43 8D35             (     flx29fms.asm):01600 [7]     RENAME  BSR     SWAP        SWAP NAMES
DB45 BDD89B           (     flx29fms.asm):01601 [8]             JSR     FNDNAM      GO LOOK FOR IT
DB48 252A             (     flx29fms.asm):01602 [3]             BCS     RENAM5      ERROR?
DB4A 2724             (     flx29fms.asm):01603 [3]             BEQ     RENAM4      ALREADY EXISTS?
                      (     flx29fms.asm):01604         
DB4C BED40B           (     flx29fms.asm):01605 [6]             LDX     FCBSTR
DB4F C60B             (     flx29fms.asm):01606 [2]             LDB     #NL         SET COUNTER
                      (     flx29fms.asm):01607         
DB51 A68824           (     flx29fms.asm):01608 [4+1]   RENAM1  LDA     FWB,X       GET CHAR
DB54 A704             (     flx29fms.asm):01609 [4+1]           STA     FFN,X       MOVE BACK
DB56 3001             (     flx29fms.asm):01610 [4+1]           LEAX    1,X         BUMP THE POINTER
DB58 5A               (     flx29fms.asm):01611 [2]             DECB                DEC THE COUNT
DB59 26F6             (     flx29fms.asm):01612 [3]             BNE     RENAM1
DB5B 8D4D             (     flx29fms.asm):01613 [7]             BSR     SWPNM       SWAP AND FIND
DB5D 2515             (     flx29fms.asm):01614 [3]             BCS     RENAM5      ERROR?
DB5F BED40B           (     flx29fms.asm):01615 [6]             LDX     FCBSTR      GET POINTER
DB62 A60F             (     flx29fms.asm):01616 [4+1]           LDA     FID,X       GET ATT BYTE
DB64 8580             (     flx29fms.asm):01617 [2]             BITA    #$80
DB66 26D6             (     flx29fms.asm):01618 [3]             BNE     WTAPP6
DB68 8560             (     flx29fms.asm):01619 [2]             BITA    #$60        CHECK DP BIT
DB6A 2609             (     flx29fms.asm):01620 [3]             BNE     RENAM6
DB6C 8D0C             (     flx29fms.asm):01621 [7]             BSR     SWAP        SWAP NAMES
DB6E 2055             (     flx29fms.asm):01622 [3]             BRA     DELNA2      WRITE DIRECTORY
                      (     flx29fms.asm):01623         
DB70 C603             (     flx29fms.asm):01624 [2]     RENAM4  LDB     #FEER       SET ERROR
DB72 1A01             (     flx29fms.asm):01625 [3]             ORCC    #1          SEC SHOW ERROR
DB74 39               (     flx29fms.asm):01626 [5]     RENAM5  RTS
                      (     flx29fms.asm):01627         
DB75 C60C             (     flx29fms.asm):01628 [2]     RENAM6  LDB     #DPER       SET ERROR
DB77 1A01             (     flx29fms.asm):01629 [3]             ORCC    #1          SEC SHOW ERROR
DB79 39               (     flx29fms.asm):01630 [5]             RTS
                      (     flx29fms.asm):01631         
                      (     flx29fms.asm):01632         * SWAP
                      (     flx29fms.asm):01633         *
                      (     flx29fms.asm):01634         * SWAP THE NAME IN FLR WITH FFN.
                      (     flx29fms.asm):01635         * IF FLR HAS NULL EXT SET AS FFN.
                      (     flx29fms.asm):01636         
DB7A BED40B           (     flx29fms.asm):01637 [6]     SWAP    LDX     FCBSTR      SET FCB POINTER
DB7D 860B             (     flx29fms.asm):01638 [2]             LDA     #NL         SET COUNT
DB7F B7D411           (     flx29fms.asm):01639 [5]             STA     ETRIES      SAVE IT
                      (     flx29fms.asm):01640         
DB82 A604             (     flx29fms.asm):01641 [4+1]   SWAP2   LDA     FFN,X       GET CHARACTER
DB84 E68835           (     flx29fms.asm):01642 [4+1]           LDB     FLR,X       GET OTHER
DB87 A78835           (     flx29fms.asm):01643 [4+1]           STA     FLR,X       SWAP THEM
DB8A E704             (     flx29fms.asm):01644 [4+1]           STB     FFN,X
DB8C 3001             (     flx29fms.asm):01645 [4+1]           LEAX    1,X         BUMP TO NEXT
DB8E 7AD411           (     flx29fms.asm):01646 [7]             DEC     ETRIES      DEC THE COUNT
DB91 26EF             (     flx29fms.asm):01647 [3]             BNE     SWAP2       AGAIN?
                      (     flx29fms.asm):01648         
DB93 BED40B           (     flx29fms.asm):01649 [6]             LDX     FCBSTR      RESTORE POINTER
DB96 A60C             (     flx29fms.asm):01650 [4+1]           LDA     FNE,X       GET IST CHAR
DB98 260C             (     flx29fms.asm):01651 [3]             BNE     SWAP6       IS IT NULL?
DB9A C603             (     flx29fms.asm):01652 [2]             LDB     #3          SET COUNT
DB9C A6883D           (     flx29fms.asm):01653 [4+1]   SWAP4   LDA     FLR+8,X     GET CHAR
DB9F A70C             (     flx29fms.asm):01654 [4+1]           STA     FNE,X       SAVE IT
DBA1 3001             (     flx29fms.asm):01655 [4+1]           LEAX    1,X         BUMP TO NEXT
DBA3 5A               (     flx29fms.asm):01656 [2]             DECB                DEC THE COUNT
DBA4 26F6             (     flx29fms.asm):01657 [3]             BNE     SWAP4
DBA6 BED40B           (     flx29fms.asm):01658 [6]     SWAP6   LDX     FCBSTR      RESTORE POINTER
DBA9 39               (     flx29fms.asm):01659 [5]             RTS
                      (     flx29fms.asm):01660         
                      (     flx29fms.asm):01661         * SWPNM
                      (     flx29fms.asm):01662         *
                      (     flx29fms.asm):01663         * SWAP NAMES AND DO FNDNAM
                      (     flx29fms.asm):01664         
DBAA 8DCE             (     flx29fms.asm):01665 [7]     SWPNM   BSR     SWAP        GO DO SWAP
DBAC BDD89B           (     flx29fms.asm):01666 [8]     SWPNM2  JSR     FNDNAM      FIND NAME
DBAF 2507             (     flx29fms.asm):01667 [3]             BCS     SWPNM4      ERROR?
DBB1 2606             (     flx29fms.asm):01668 [3]             BNE     SWPNM5      NO FIND?
                      (     flx29fms.asm):01669         
DBB3 BED40B           (     flx29fms.asm):01670 [6]             LDX     FCBSTR      RESTORE POINTER
DBB6 1CFE             (     flx29fms.asm):01671 [3]             ANDCC   #$FE        CLC CLEAR ERRORS
DBB8 39               (     flx29fms.asm):01672 [5]     SWPNM4  RTS
                      (     flx29fms.asm):01673         
DBB9 C604             (     flx29fms.asm):01674 [2]     SWPNM5  LDB     #NFER       SET ERROR
DBBB 1A01             (     flx29fms.asm):01675 [3]             ORCC    #1          SEC
DBBD 39               (     flx29fms.asm):01676 [5]             RTS
                      (     flx29fms.asm):01677         
                      (     flx29fms.asm):01678         * DELNAM
                      (     flx29fms.asm):01679         *
                      (     flx29fms.asm):01680         * DELETE FILE NAME IN DIR
                      (     flx29fms.asm):01681         
DBBE BED40B           (     flx29fms.asm):01682 [6]     DELNAM  LDX     FCBSTR      POINT TO FCB
DBC1 86FF             (     flx29fms.asm):01683 [2]             LDA     #$FF        SET NEGATIVE
DBC3 A704             (     flx29fms.asm):01684 [4+1]           STA     FFN,X       SET VALUE
                      (     flx29fms.asm):01685         
DBC5 BDD972           (     flx29fms.asm):01686 [8]     DELNA2  JSR     WRTDIR      WRITE DIRECTORY
DBC8 BED40B           (     flx29fms.asm):01687 [6]             LDX     FCBSTR      SET POINTER
DBCB 8600             (     flx29fms.asm):01688 [2]             LDA     #0          CLEAR STATUS
DBCD A702             (     flx29fms.asm):01689 [4+1]           STA     FAS,X
DBCF 39               (     flx29fms.asm):01690 [5]             RTS
                      (     flx29fms.asm):01691         
                      (     flx29fms.asm):01692         * WRITIT
                      (     flx29fms.asm):01693         *
                      (     flx29fms.asm):01694         * WRITIT PUTS AND WRITES NEW
                      (     flx29fms.asm):01695         * FORWARD LINK IN SECTOR.
                      (     flx29fms.asm):01696         
DBD0 ED8840           (     flx29fms.asm):01697 [5+1]   WRITIT  STD     FSB,X       SET NEW LINK
DBD3 BDD6A7           (     flx29fms.asm):01698 [8]             JSR     WRITSS      WRITE SECTOR
DBD6 2414             (     flx29fms.asm):01699 [3]             BCC     WRTER4
                      (     flx29fms.asm):01700         
DBD8 C540             (     flx29fms.asm):01701 [2]     WRTERR  BITB    #$40        W.P. ?
DBDA 2608             (     flx29fms.asm):01702 [3]             BNE     WRTER1
DBDC C580             (     flx29fms.asm):01703 [2]             BITB    #$80
DBDE 270A             (     flx29fms.asm):01704 [3]             BEQ     WRTER3
DBE0 C610             (     flx29fms.asm):01705 [2]             LDB     #NRER       SET NOT READY
DBE2 2006             (     flx29fms.asm):01706 [3]             BRA     WRTER3
                      (     flx29fms.asm):01707         
DBE4 C60B             (     flx29fms.asm):01708 [2]     WRTER1  LDB     #WPER       SET WP ERROR
DBE6 2002             (     flx29fms.asm):01709 [3]             BRA     WRTER3
                      (     flx29fms.asm):01710         
                      (     flx29fms.asm):01711         * ---- No path to this code
                      (     flx29fms.asm):01712         
DBE8 C60A             (     flx29fms.asm):01713 [2]     WRTER2  LDB     #WTER       SET WRITE ERROR
                      (     flx29fms.asm):01714         
                      (     flx29fms.asm):01715         * ----
                      (     flx29fms.asm):01716         
DBEA 1A01             (     flx29fms.asm):01717 [3]     WRTER3  ORCC    #1
DBEC 39               (     flx29fms.asm):01718 [5]     WRTER4  RTS
                      (     flx29fms.asm):01719         
                      (     flx29fms.asm):01720         * DELETE
                      (     flx29fms.asm):01721         *
                      (     flx29fms.asm):01722         * DELETE A SYSTEM FILE RETURNING ITS
                      (     flx29fms.asm):01723         * SECTORS BACK TO THE LIST OF AVAIL.
                      (     flx29fms.asm):01724         *
                      (     flx29fms.asm):01725         *   ENTRY: NAME IN FFN
                      (     flx29fms.asm):01726         *   EXIT:  ALL CHANGED
                      (     flx29fms.asm):01727         *          CS IF ERROR
                      (     flx29fms.asm):01728         
DBED BDD920           (     flx29fms.asm):01729 [8]     DELETE  JSR     GETAVL      GET SEC MAP
DBF0 255E             (     flx29fms.asm):01730 [3]             BCS     DELET6      ERROR?
DBF2 8DB8             (     flx29fms.asm):01731 [7]             BSR     SWPNM2      FIND NAME
DBF4 255A             (     flx29fms.asm):01732 [3]             BCS     DELET6      ERROR?
                      (     flx29fms.asm):01733         
DBF6 BED40B           (     flx29fms.asm):01734 [6]             LDX     FCBSTR      GET POINTER
DBF9 A60F             (     flx29fms.asm):01735 [4+1]           LDA     FID,X       GET ATT BYTE
DBFB 8580             (     flx29fms.asm):01736 [2]             BITA    #$80        CHECK WP BIT
DBFD 2652             (     flx29fms.asm):01737 [3]             BNE     DELET7
                      (     flx29fms.asm):01738         
DBFF 8560             (     flx29fms.asm):01739 [2]             BITA    #$60        CHECK DP BIT
DC01 2652             (     flx29fms.asm):01740 [3]             BNE     DELET8
                      (     flx29fms.asm):01741         
DC03 BDD78F           (     flx29fms.asm):01742 [8]             JSR     FSECMP      FIND SEC MAP
DC06 BED41B           (     flx29fms.asm):01743 [6]             LDX     AVLPNT      GET MAP POINTER
DC09 EC02             (     flx29fms.asm):01744 [5+1]           LDD     2,X         GET LAST AVAIL
DC0B 260F             (     flx29fms.asm):01745 [3]             BNE     DELET2      IS IT NULL?
DC0D BED40B           (     flx29fms.asm):01746 [6]             LDX     FCBSTR      RESTORE POINTER
DC10 EC8811           (     flx29fms.asm):01747 [5+1]           LDD     FSA,X       GET START ADR
DC13 2733             (     flx29fms.asm):01748 [3]             BEQ     DELET5
DC15 BED41B           (     flx29fms.asm):01749 [6]             LDX     AVLPNT      POINT TO AVAILS
DC18 ED00             (     flx29fms.asm):01750 [5+1]           STD     0,X         SET NEW
DC1A 2014             (     flx29fms.asm):01751 [3]             BRA     DELET4      JUMP AHEAD
                      (     flx29fms.asm):01752         
DC1C BED40B           (     flx29fms.asm):01753 [6]     DELET2  LDX     FCBSTR      SET POINTER
DC1F BDD628           (     flx29fms.asm):01754 [8]             JSR     RDNEX2      READ SECTOR
DC22 252C             (     flx29fms.asm):01755 [3]             BCS     DELET6      ERRORS?
DC24 BED40B           (     flx29fms.asm):01756 [6]             LDX     FCBSTR      RESTORE POINTER
DC27 EC8811           (     flx29fms.asm):01757 [5+1]           LDD     FSA,X       GET START ADR
DC2A 271C             (     flx29fms.asm):01758 [3]             BEQ     DELET5
DC2C 8DA2             (     flx29fms.asm):01759 [7]             BSR     WRITIT      SET LINK
DC2E 2520             (     flx29fms.asm):01760 [3]             BCS     DELET6      ERROR?
                      (     flx29fms.asm):01761         
DC30 BED40B           (     flx29fms.asm):01762 [6]     DELET4  LDX     FCBSTR      SET FCB PNTR
DC33 EC8813           (     flx29fms.asm):01763 [5+1]           LDD     FEA,X       GET END ADR
DC36 BED41B           (     flx29fms.asm):01764 [6]             LDX     AVLPNT      POINT TO AVAILS
DC39 ED02             (     flx29fms.asm):01765 [5+1]           STD     2,X         SET NEW LAST
DC3B BED40B           (     flx29fms.asm):01766 [6]             LDX     FCBSTR      SET POINTER
DC3E EC8815           (     flx29fms.asm):01767 [5+1]           LDD     FSZ,X       GET SIZE
DC41 BED41B           (     flx29fms.asm):01768 [6]             LDX     AVLPNT      POINT TO AVAILS
DC44 E304             (     flx29fms.asm):01769 [6+1]           ADDD    4,X         ADD IN SECTORS
DC46 ED04             (     flx29fms.asm):01770 [5+1]           STD     4,X         SAVE NEW COUNT
                      (     flx29fms.asm):01771         
DC48 BDDBBE           (     flx29fms.asm):01772 [8]     DELET5  JSR     DELNAM      DELETE NAME
DC4B 2503             (     flx29fms.asm):01773 [3]             BCS     DELET6      ERROR?
DC4D BDD950           (     flx29fms.asm):01774 [8]             JSR     PUTAVL      WRITE AVAIL SEC
DC50 39               (     flx29fms.asm):01775 [5]     DELET6  RTS
                      (     flx29fms.asm):01776         
DC51 C60B             (     flx29fms.asm):01777 [2]     DELET7  LDB     #WPER       SET ERROR
DC53 2002             (     flx29fms.asm):01778 [3]             BRA     DELET9
                      (     flx29fms.asm):01779         
DC55 C60C             (     flx29fms.asm):01780 [2]     DELET8  LDB     #DPER       SET ERROR
DC57 1A01             (     flx29fms.asm):01781 [3]     DELET9  ORCC    #1          SEC SHOW ERROR
DC59 39               (     flx29fms.asm):01782 [5]             RTS
                      (     flx29fms.asm):01783         
                      (     flx29fms.asm):01784         * UPDFSM
                      (     flx29fms.asm):01785         *
                      (     flx29fms.asm):01786         * UPDATE FILE SECTOR MAP
                      (     flx29fms.asm):01787         
DC5A EC881E           (     flx29fms.asm):01788 [5+1]   UPDFSM  LDD     FCS,X       GET CURRENT SEC
DC5D 5C               (     flx29fms.asm):01789 [2]             INCB    CHECK       IF SEQUENTIAL
DC5E E1883C           (     flx29fms.asm):01790 [4+1]           CMPB    FMX,X       CHECK MAX
DC61 2303             (     flx29fms.asm):01791 [3]             BLS     UPDFS2
DC63 C601             (     flx29fms.asm):01792 [2]             LDB     #1          SET SECTOR 1
DC65 4C               (     flx29fms.asm):01793 [2]             INCA                BUMP TRACK
DC66 10A38813         (     flx29fms.asm):01794 [7+1]   UPDFS2  CMPD    FEA,X       CHECK END
DC6A 260E             (     flx29fms.asm):01795 [3]             BNE     UPDFS4
DC6C A68837           (     flx29fms.asm):01796 [4+1]           LDA     SBC,X       CHECK MAX COUNT
DC6F 81FF             (     flx29fms.asm):01797 [2]             CMPA    #$FF        IS IT MAX?
DC71 2707             (     flx29fms.asm):01798 [3]             BEQ     UPDFS4
DC73 4C               (     flx29fms.asm):01799 [2]             INCA                BUMP COUNT
DC74 A78837           (     flx29fms.asm):01800 [4+1]           STA     SBC,X       SAVE IT
DC77 1CFE             (     flx29fms.asm):01801 [3]             CLC                 CLEAR ERRORS
DC79 39               (     flx29fms.asm):01802 [5]             RTS                 RETURN
                      (     flx29fms.asm):01803         
DC7A 8D33             (     flx29fms.asm):01804 [7]     UPDFS4  BSR     WTFSM       WRITE FSM
DC7C 2530             (     flx29fms.asm):01805 [3]             BCS     UPDFS9      ERROR?
DC7E BED40B           (     flx29fms.asm):01806 [6]             LDX     FCBSTR      SET POINTER
DC81 A6883A           (     flx29fms.asm):01807 [4+1]           LDA     FNK+2,X     GET OFFSET
DC84 8B03             (     flx29fms.asm):01808 [2]             ADDA    #3          BUMP TO NEXT ENTRY
DC86 2616             (     flx29fms.asm):01809 [3]             BNE     UPDFS8      END OF SECTOR?
DC88 EC881E           (     flx29fms.asm):01810 [5+1]           LDD     FCS,X       GET CURRENT
DC8B 10A38811         (     flx29fms.asm):01811 [7+1]           CMPD    FSA,X       START ADDR?
DC8F 2705             (     flx29fms.asm):01812 [3]             BEQ     UPDFS7
DC91 C617             (     flx29fms.asm):01813 [2]     UPDFS6  LDB     #FSER       SET ERROR
DC93 1A01             (     flx29fms.asm):01814 [3]             SEC
DC95 39               (     flx29fms.asm):01815 [5]             RTS                 RETURN
                      (     flx29fms.asm):01816         
DC96 EC8840           (     flx29fms.asm):01817 [5+1]   UPDFS7  LDD     FSB,X       GET LINK
DC99 ED8838           (     flx29fms.asm):01818 [5+1]   UPDF75  STD     FNK,X       SET POINTER
DC9C 8604             (     flx29fms.asm):01819 [2]             LDA     #4          SET INITIAL OFFSET
DC9E A7883A           (     flx29fms.asm):01820 [4+1]   UPDFS8  STA     FNK+2,X
DCA1 EC8813           (     flx29fms.asm):01821 [5+1]           LDD     FEA,X       GET END ADDR
DCA4 ED8835           (     flx29fms.asm):01822 [5+1]           STD     FLR,X       MARK POSITION
DCA7 8601             (     flx29fms.asm):01823 [2]             LDA     #1          SET COUNT
DCA9 A78837           (     flx29fms.asm):01824 [4+1]           STA     SBC,X
DCAC 1CFE             (     flx29fms.asm):01825 [3]             CLC                 CLEAR ERRORS
DCAE 39               (     flx29fms.asm):01826 [5]     UPDFS9  RTS                 RETURN
                      (     flx29fms.asm):01827         
                      (     flx29fms.asm):01828         * WTFSM
                      (     flx29fms.asm):01829         *
                      (     flx29fms.asm):01830         * WRITE FILE SECTOR MAP
                      (     flx29fms.asm):01831         
DCAF EC8838           (     flx29fms.asm):01832 [5+1]   WTFSM   LDD     FNK,X       GET RECORD
DCB2 BDD628           (     flx29fms.asm):01833 [8]             JSR     RDNEX2      READ SECTOR
DCB5 25F7             (     flx29fms.asm):01834 [3]             BCS     UPDFS9      ERROR?
DCB7 BED40B           (     flx29fms.asm):01835 [6]             LDX     FCBSTR
DCBA 1F12             (     flx29fms.asm):01836 [6]             TFR     X,Y
DCBC E6883A           (     flx29fms.asm):01837 [4+1]           LDB     FNK+2,X
                      (     flx29fms.asm):01838         
                      (     flx29fms.asm):01839         * LEAX    B,X   < original code
                      (     flx29fms.asm):01840         * Add NOP and ABX
                      (     flx29fms.asm):01841         
DCBF 12               (     flx29fms.asm):01842 [2]             NOP
DCC0 3A               (     flx29fms.asm):01843 [3]             ABX                 CORRECTED 2/4/80
DCC1 C603             (     flx29fms.asm):01844 [2]             LDB     #3
DCC3 A6A835           (     flx29fms.asm):01845 [4+1]   WTFSM2  LDA     FLR,Y
DCC6 3121             (     flx29fms.asm):01846 [4+1]           LEAY    1,Y
DCC8 A78840           (     flx29fms.asm):01847 [4+1]           STA     FSB,X
DCCB 3001             (     flx29fms.asm):01848 [4+1]           LEAX    1,X
DCCD 5A               (     flx29fms.asm):01849 [2]             DECB                DEC THE COUNT
DCCE 26F3             (     flx29fms.asm):01850 [3]             BNE     WTFSM2
DCD0 BDD6A7           (     flx29fms.asm):01851 [8]             JSR     WRITSS      WRITE SECTOR
DCD3 24D9             (     flx29fms.asm):01852 [3]             BCC     UPDFS9      ERROR?
DCD5 7EDBD8           (     flx29fms.asm):01853 [4]             JMP     WRTERR      SET ERROR
                      (     flx29fms.asm):01854         
                      (     flx29fms.asm):01855         * SETMAX
                      (     flx29fms.asm):01856         *
                      (     flx29fms.asm):01857         * SET MAX SECTOR NUMBER
                      (     flx29fms.asm):01858         
DCD8 BDD818           (     flx29fms.asm):01859 [8]     SETMAX  JSR     OPNSIR      GET SECTOR
DCDB BDD614           (     flx29fms.asm):01860 [8]             JSR     RDNEXT
DCDE 2546             (     flx29fms.asm):01861 [3]             BCS     POSI05      ERROR?
DCE0 BED40B           (     flx29fms.asm):01862 [6]             LDX     FCBSTR      SET FCB PNTR
DCE3 4F               (     flx29fms.asm):01863 [2]             CLRA
DCE4 5F               (     flx29fms.asm):01864 [2]             CLRB
DCE5 ED8820           (     flx29fms.asm):01865 [5+1]           STD     FRN,X       CLEAR REC NUM
DCE8 A68867           (     flx29fms.asm):01866 [4+1]           LDA     FSB+39,X    GET MAX
DCEB A7883C           (     flx29fms.asm):01867 [4+1]           STA     FMX,X       SAVE MAX
DCEE 5F               (     flx29fms.asm):01868 [2]             CLRB                GET SECTOR LENGTH \\\\
DCEF 6F8840           (     flx29fms.asm):01869 [6+1]   SETMA2  CLR     FSB,X       CLEAR BYTES
DCF2 3001             (     flx29fms.asm):01870 [4+1]           LEAX    1,X
DCF4 5A               (     flx29fms.asm):01871 [2]             DECB                DEC THE COUNTER
DCF5 26F8             (     flx29fms.asm):01872 [3]             BNE     SETMA2
DCF7 BED40B           (     flx29fms.asm):01873 [6]             LDX     FCBSTR      RESTORE POINTER
DCFA 1CFE             (     flx29fms.asm):01874 [3]             CLC                 CLEAR ERRORS
DCFC 39               (     flx29fms.asm):01875 [5]             RTS                 RETURN
                      (     flx29fms.asm):01876         
                      (     flx29fms.asm):01877         * BKREC
                      (     flx29fms.asm):01878         *
                      (     flx29fms.asm):01879         * BACK UP ONE RECORD
                      (     flx29fms.asm):01880         
DCFD BED40B           (     flx29fms.asm):01881 [6]     BKREC   LDX     FCBSTR      GET FCB
DD00 A68817           (     flx29fms.asm):01882 [4+1]           LDA     FMP,X       RANDOM?
DD03 271D             (     flx29fms.asm):01883 [3]             BEQ     POSIT0
DD05 EC8820           (     flx29fms.asm):01884 [5+1]           LDD     FRN,X       GET REC NUMBER
DD08 830001           (     flx29fms.asm):01885 [4]             SUBD    #1          DEC BY ONE
DD0B 2A03             (     flx29fms.asm):01886 [3]             BPL     BKREC2      UNDERFLOW?
DD0D 7EDDB2           (     flx29fms.asm):01887 [4]             JMP     POSIT8
DD10 ED8820           (     flx29fms.asm):01888 [5+1]   BKREC2  STD     FRN,X       SAVE NEW
                      (     flx29fms.asm):01889         
                      (     flx29fms.asm):01890         * POSIT
                      (     flx29fms.asm):01891         *
                      (     flx29fms.asm):01892         * POSITION TO FRN RECORD NUMBER
                      (     flx29fms.asm):01893         
DD13 BDDAC8           (     flx29fms.asm):01894 [8]     POSIT   JSR     DOSTAT      CHECK STATUS
DD16 250E             (     flx29fms.asm):01895 [3]             BCS     POSI05      ERROR?
DD18 46               (     flx29fms.asm):01896 [2]             RORA
DD19 2407             (     flx29fms.asm):01897 [3]             BCC     POSIT0      ERROR?
DD1B 6F00             (     flx29fms.asm):01898 [6+1]           CLR     0,X         CLEAR FFC
DD1D A68817           (     flx29fms.asm):01899 [4+1]           LDA     FMP,X       CHECK RANDOM
DD20 2605             (     flx29fms.asm):01900 [3]             BNE     POSIT1      ERROR?
                      (     flx29fms.asm):01901         
DD22 C612             (     flx29fms.asm):01902 [2]     POSIT0  LDB     #STER       SET ERROR
DD24 1A01             (     flx29fms.asm):01903 [3]             SEC
DD26 39               (     flx29fms.asm):01904 [5]     POSI05  RTS                 RETURN
                      (     flx29fms.asm):01905         
DD27 7FD411           (     flx29fms.asm):01906 [7]     POSIT1  CLR     ETRIES      CLEAR COUNT
DD2A EC8811           (     flx29fms.asm):01907 [5+1]           LDD     FSA,X       GET START ADDR
DD2D 10AE8820         (     flx29fms.asm):01908 [6+1]           LDY     FRN,X       CHECK FOR 0
DD31 276A             (     flx29fms.asm):01909 [3]             BEQ     POSIT7      GO DO ZERO
DD33 BDDDB7           (     flx29fms.asm):01910 [8]     POSIT2  JSR     GETFSM      GET FSM
DD36 25EE             (     flx29fms.asm):01911 [3]             BCS     POSI05
DD38 4F               (     flx29fms.asm):01912 [2]             CLRA                CLEAR COUNT
DD39 5F               (     flx29fms.asm):01913 [2]             CLRB
DD3A 6D02             (     flx29fms.asm):01914 [6+1]   POSIT3  TST     2,X         CHECK FOR EOF
DD3C 2774             (     flx29fms.asm):01915 [3]             BEQ     POSIT8
DD3E EB02             (     flx29fms.asm):01916 [4+1]           ADDB    2,X         ADD IN NEW
DD40 8900             (     flx29fms.asm):01917 [2]             ADCA    #0
DD42 BFD40F           (     flx29fms.asm):01918 [6]             STX     DATAPT
DD45 BED40B           (     flx29fms.asm):01919 [6]             LDX     FCBSTR
DD48 10A38820         (     flx29fms.asm):01920 [7+1]           CMPD    FRN,X       CHECK NUMBER
DD4C 242C             (     flx29fms.asm):01921 [3]             BHS     POSIT6
DD4E BED40F           (     flx29fms.asm):01922 [6]     POSIT4  LDX     DATAPT      RESTORE POINTER
DD51 3003             (     flx29fms.asm):01923 [4+1]           LEAX    3,X         BUMP TO NEXT
DD53 3402             (     flx29fms.asm):01924 [5+1]           PSHS A              SAVE COUNT
DD55 B6D411           (     flx29fms.asm):01925 [5]             LDA     ETRIES
DD58 4C               (     flx29fms.asm):01926 [2]             INCA                BUMP POSITION
DD59 B7D411           (     flx29fms.asm):01927 [5]             STA     ETRIES      SAVE RESULT
DD5C 8154             (     flx29fms.asm):01928 [2]             CMPA    #84         LAST RECORD?
DD5E 2708             (     flx29fms.asm):01929 [3]             BEQ     POSIT5
DD60 81A8             (     flx29fms.asm):01930 [2]             CMPA    #168
DD62 3502             (     flx29fms.asm):01931 [5+1]           PULS A              RESTORE TOTAL
DD64 274C             (     flx29fms.asm):01932 [3]             BEQ     POSIT8      ERROR?
DD66 20D2             (     flx29fms.asm):01933 [3]             BRA     POSIT3      REPEAT
DD68 3404             (     flx29fms.asm):01934 [5+1]   POSIT5  PSHS B
DD6A BED40B           (     flx29fms.asm):01935 [6]             LDX     FCBSTR      SET POINTER
DD6D EC8840           (     flx29fms.asm):01936 [5+1]           LDD     FSB,X
DD70 8D45             (     flx29fms.asm):01937 [7]             BSR     GETFSM      GET FSM
DD72 253E             (     flx29fms.asm):01938 [3]             BCS     POSIT8      ERROR?
DD74 3504             (     flx29fms.asm):01939 [5+1]           PULS B
DD76 3502             (     flx29fms.asm):01940 [5+1]           PULS A              RESTORE TOTAL
DD78 20C0             (     flx29fms.asm):01941 [3]             BRA     POSIT3      REPEAT
DD7A A38820           (     flx29fms.asm):01942 [6+1]   POSIT6  SUBD    FRN,X       SUB REC NUM
DD7D BED40F           (     flx29fms.asm):01943 [6]             LDX     DATAPT      RESTORE POINTER
DD80 A602             (     flx29fms.asm):01944 [4+1]           LDA     2,X
DD82 3404A0E0         (     flx29fms.asm):01945 [12]            SBA
DD86 4A               (     flx29fms.asm):01946 [2]             DECA                FIX UP COUNT
DD87 1F89             (     flx29fms.asm):01947 [6]             TFR     A,B
DD89 A600             (     flx29fms.asm):01948 [4+1]           LDA     0,X         GET TRACK
DD8B EB01             (     flx29fms.asm):01949 [4+1]           ADDB    1,X         ADD IN SECTOR
DD8D BED40B           (     flx29fms.asm):01950 [6]             LDX     FCBSTR
DD90 2505             (     flx29fms.asm):01951 [3]             BCS     POSI68
DD92 E1883C           (     flx29fms.asm):01952 [4+1]   POSI65  CMPB    FMX,X       MAX?
DD95 2306             (     flx29fms.asm):01953 [3]             BLS     POSIT7
DD97 E0883C           (     flx29fms.asm):01954 [4+1]   POSI68  SUBB    FMX,X       FIX IF SO
DD9A 4C               (     flx29fms.asm):01955 [2]             INCA                BUMP TRACK
DD9B 20F5             (     flx29fms.asm):01956 [3]             BRA     POSI65
DD9D BDD628           (     flx29fms.asm):01957 [8]     POSIT7  JSR     RDNEX2      READ NEXT
DDA0 2514             (     flx29fms.asm):01958 [3]             BCS     POSI85      ERROR?
DDA2 BED40B           (     flx29fms.asm):01959 [6]             LDX     FCBSTR
DDA5 EC8842           (     flx29fms.asm):01960 [5+1]           LDD     FSB+2,X     GET LRN
DDA8 10A38820         (     flx29fms.asm):01961 [7+1]           CMPD    FRN,X       COMPARE TO FRN
DDAC 2714             (     flx29fms.asm):01962 [3]             BEQ     GETS1
DDAE C619             (     flx29fms.asm):01963 [2]     POSI75  LDB     #RMER       SET ERROR
DDB0 2002             (     flx29fms.asm):01964 [3]             BRA     POSI82
DDB2 C618             (     flx29fms.asm):01965 [2]     POSIT8  LDB     #RRER       SET ERROR
DDB4 1A01             (     flx29fms.asm):01966 [3]     POSI82  SEC
DDB6 39               (     flx29fms.asm):01967 [5]     POSI85  RTS     RETURN
                      (     flx29fms.asm):01968         
                      (     flx29fms.asm):01969         * GET FSM SECTOR
                      (     flx29fms.asm):01970         
DDB7 BDD628           (     flx29fms.asm):01971 [8]     GETFSM  JSR     RDNEX2      READ NEXT SEC
DDBA 2508             (     flx29fms.asm):01972 [3]             BCS     GETS2       ERROR?
DDBC BED40B           (     flx29fms.asm):01973 [6]             LDX     FCBSTR      SET INDEX
DDBF C644             (     flx29fms.asm):01974 [2]             LDB     #FSB+4      SET OFFSET
DDC1 3A               (     flx29fms.asm):01975 [3]             ABX
DDC2 1CFE             (     flx29fms.asm):01976 [3]     GETS1   CLC                 CLEAR ERRORS
DDC4 39               (     flx29fms.asm):01977 [5]     GETS2   RTS
                      (     flx29fms.asm):01978         
                      (     flx29fms.asm):01979         * RSTNAM
                      (     flx29fms.asm):01980         *
                      (     flx29fms.asm):01981         * RESTORE NAME FROM FWB TO FFN.
                      (     flx29fms.asm):01982         
DDC5 BED40B           (     flx29fms.asm):01983 [6]     RSTNAM  LDX     FCBSTR      SET FCB
DDC8 C60B             (     flx29fms.asm):01984 [2]             LDB     #NL         SET COUNTER
DDCA A68824           (     flx29fms.asm):01985 [4+1]   RSTNA2  LDA     FWB,X       GET CHARACTER
DDCD A704             (     flx29fms.asm):01986 [4+1]           STA     FFN,X       PUT IT
DDCF 3001             (     flx29fms.asm):01987 [5]             INX                 BUMP THE POINTER
DDD1 5A               (     flx29fms.asm):01988 [2]             DECB                DEC THE COUNT
DDD2 26F6             (     flx29fms.asm):01989 [3]             BNE     RSTNA2
DDD4 39               (     flx29fms.asm):01990 [5]             RTS                 RETURN
                      (     flx29fms.asm):01991         
                      (     flx29fms.asm):01992         * NXTRDY
                      (     flx29fms.asm):01993         *
                      (     flx29fms.asm):01994         * NXTRDY RETURNS THE DRIVE NUMBER IN
                      (     flx29fms.asm):01995         * FCB+FDN OF THE NEXT READY DRIVE.
                      (     flx29fms.asm):01996         * CS IF NO MORE READY DRIVES.
                      (     flx29fms.asm):01997         
DDD5 BED40B           (     flx29fms.asm):01998 [6]     NXTRDY  LDX     FCBSTR      GET FCB
DDD8 A603             (     flx29fms.asm):01999 [4+1]           LDA     FDN,X       GET DRIVE NUMBER
DDDA 4C               (     flx29fms.asm):02000 [2]             INCA                BUMP BY ONE
DDDB 8104             (     flx29fms.asm):02001 [2]             CMPA    #4          PAST RANGE?
DDDD 240F             (     flx29fms.asm):02002 [3]             BHS     NXTRD6
DDDF A703             (     flx29fms.asm):02003 [4+1]           STA     FDN,X       SAVE NEW NUMBER
DDE1 2605             (     flx29fms.asm):02004 [3]             BNE     NXTRD2      DRIVE 0 ?
DDE3 BDDE0F           (     flx29fms.asm):02005 [8]             JSR     CHECK       CHECK IF READY
DDE6 2003             (     flx29fms.asm):02006 [3]             BRA     NXTRD4
DDE8 BDDE12           (     flx29fms.asm):02007 [8]     NXTRD2  JSR     QUKCHK      QUICK CHECK
DDEB 25E8             (     flx29fms.asm):02008 [3]     NXTRD4  BCS     NXTRDY      CHECK NEXT DRIVE
DDED 39               (     flx29fms.asm):02009 [5]             RTS                 RETURN
DDEE C610             (     flx29fms.asm):02010 [2]     NXTRD6  LDB     #NRER       SET ERROR
DDF0 1A01             (     flx29fms.asm):02011 [3]             SEC
DDF2 39               (     flx29fms.asm):02012 [5]             RTS                 RETURN
                      (     flx29fms.asm):02013         
                      (     flx29fms.asm):02014                 END

Symbol Table:
[ G] ADER                             0011
[ G] ASNN65                           D7D0
[ G] ASNN85                           D803
[ G] ASNNX1                           D7A7
[ G] ASNNX2                           D7AA
[ G] ASNNX4                           D7B8
[ G] ASNNX6                           D7C0
[ G] ASNNX7                           D7EF
[ G] ASNNX8                           D7F7
[ G] ASNNX9                           D804
[ G] ASNNXT                           D7A1
[ G] AVLPNT                           D41B
[ G] BKLN                             D418
[ G] BKREC                            DCFD
[ G] BKREC2                           DD10
[ G] CHECK                            DE0F
[ G] CHKWT                            DAB1
[ G] CHKWT2                           DABE
[ G] CHKWT4                           DAC5
[ G] CLD                              D413
[ G] CLER                             0016
[ G] CLOS32                           DB05
[ G] CLOS35                           DB0D
[ G] CLOSE                            DADA
[ G] CLOSE1                           DAE2
[ G] CLOSE2                           DAEA
[ G] CLOSE3                           DAF4
[ G] CLOSE4                           DB0F
[ G] CLRFC2                           D544
[ G] CLRFCB                           D53B
[ G] CLRLRN                           D746
[ G] CLRTRY                           D670
[ G] CMND                             D47F
[ G] CMND1                            D487
[ G] CMND15                           D49D
[ G] CMND2                            D4AB
[ G] CMND3                            D4B0
[ G] CMND4                            D4B4
[ G] CMND5                            D4BC
[ G] CMND7                            D4C8
[ G] CMND8                            D4CA
[ G] CMPNA1                           D562
[ G] CMPNA4                           D576
[ G] CMPNAM                           D55D
[ G] CODTBL                           D4D2
[ G] COPNA2                           D552
[ G] COPNAM                           D54D
[ G] CUD                              D415
[ G] DAER                             000E
[ G] DATAPT                           D40F
[ G] DATE                             CC0E
[ G] DELC                             0018
[ G] DELET2                           DC1C
[ G] DELET4                           DC30
[ G] DELET5                           DC48
[ G] DELET6                           DC50
[ G] DELET7                           DC51
[ G] DELET8                           DC55
[ G] DELET9                           DC57
[ G] DELETE                           DBED
[ G] DELNA2                           DBC5
[ G] DELNAM                           DBBE
[ G] DFER                             0007
[ G] DINIT                            DE15
[ G] DIRDN                            D417
[ G] DNER                             000F
[ G] DOSTA4                           DAD9
[ G] DOSTAT                           DAC8
[ G] DPER                             000C
[ G] DREAD                            DE00
[ G] DRER                             0005
[ G] DRIVE                            DE0C
[ G] DRVINFO                          D436
[ G] DSEC                             0005
[ G] DSEEK                            DE1B
[ G] DTRK                             0000
[ G] DWARM                            DE18
[ G] DWRITE                           DE03
[ G] EFER                             0008
[ G] ETRIES                           D411
[ G] EXCLS                            D45D
[ G] EXCLS1                           D460
[ G] FAS                              0002
[ G] FBER                             0002
[ G] FCBBAS                           D409
[ G] FCBSTR                           D40B
[ G] FCD                              002F
[ G] FCS                              001E
[ G] FDI                              0022
[ G] FDN                              0003
[ G] FDT                              0019
[ G] FEA                              0013
[ G] FEER                             0003
[ G] FES                              0001
[ G] FFC                              0000
[ G] FFD                              0032
[ G] FFN                              0004
[ G] FID                              000F
[ G] FIER                             0014
[ G] FLP                              001C
[ G] FLR                              0035
[ G] FMP                              0017
[ G] FMS                              D406
[ G] FMSCLS                           D403
[ G] FMSINT                           D400
[ G] FMX                              003C
[ G] FNDFC3                           D529
[ G] FNDFC4                           D531
[ G] FNDFC6                           D537
[ G] FNDFCB                           D520
[ G] FNDN04                           D8B3
[ G] FNDN06                           D8C4
[ G] FNDN08                           D8CE
[ G] FNDNA1                           D8DC
[ G] FNDNA2                           D8E8
[ G] FNDNA3                           D8F3
[ G] FNDNA4                           D8F4
[ G] FNDNA6                           D8FF
[ G] FNDNA8                           D907
[ G] FNDNA9                           D909
[ G] FNDNAM                           D89B
[ G] FNE                              000C
[ G] FNK                              0038
[ G] FNU                              0010
[ G] FRI                              0023
[ G] FRN                              0020
[ G] FSA                              0011
[ G] FSB                              0040
[ G] FSC                              003B
[ G] FSECMP                           D78F
[ G] FSER                             0017
[ G] FSP                              003C
[ G] FSZ                              0015
[ G] FWB                              0024
[ G] GETAV2                           D932
[ G] GETAV3                           D93C
[ G] GETAV4                           D93E
[ G] GETAVL                           D920
[ G] GETCUR                           D666
[ G] GETDI2                           D94F
[ G] GETDIS                           D93F
[ G] GETFS2                           D78E
[ G] GETFSM                           DDB7
[ G] GETFST                           D78A
[ G] GETIR                            D840
[ G] GETIR1                           D85B
[ G] GETIR2                           D866
[ G] GETIR4                           D86E
[ G] GETIR8                           D87E
[ G] GETRAN                           D577
[ G] GETS1                            DDC2
[ G] GETS2                            DDC4
[ G] ICER                             0001
[ G] IFER                             000D
[ G] INER                             0015
[ G] INIT                             D43A
[ G] INIT2                            D450
[ G] INIT4                            D455
[ G] IRER                             0013
[ G] IRFAS                            0004
[ G] IRL                              0018
[ G] IRS                              0010
[ G] ISEC                             0003
[ G] LD9D6                            D9D6
[ G] LOCK                             C709
[ G] LSTFC                            0016
[ G] LSTSEC                           000F
[ G] LSTTRK                           004C
[ G] MAIND                            0005
[ G] MAXSP                            007F
[ G] NEXTS                            DA9E
[ G] NEXTS4                           DAB0
[ G] NFER                             0004
[ G] NL                               000B
[ G] NODR                             0004
[ G] NOER                             0000
[ G] NRER                             0010
[ G] NXTRD2                           DDE8
[ G] NXTRD4                           DDEB
[ G] NXTRD6                           DDEE
[ G] NXTRDY                           DDD5
[ G] OPNCLD                           D825
[ G] OPNCUD                           D81F
[ G] OPNDIR                           D825
[ G] OPNERR                           D9D8
[ G] OPNIR                            D82D
[ G] OPNR12                           D9BC
[ G] OPNR15                           D9CF
[ G] OPNRD                            D98F
[ G] OPNRD1                           D9A9
[ G] OPNRD2                           D9D1
[ G] OPNRD3                           D9D2
[ G] OPNRW                            DB10
[ G] OPNSIR                           D818
[ G] OPNW85                           DA74
[ G] OPNWT                            D9E2
[ G] OPNWT3                           D9F1
[ G] OPNWT4                           DA09
[ G] OPNWT5                           DA13
[ G] OPNWT8                           DA56
[ G] OPNWT9                           DA77
[ G] POSI05                           DD26
[ G] POSI65                           DD92
[ G] POSI68                           DD97
[ G] POSI75                           DDAE
[ G] POSI82                           DDB4
[ G] POSI85                           DDB6
[ G] POSIT                            DD13
[ G] POSIT0                           DD22
[ G] POSIT1                           DD27
[ G] POSIT2                           DD33
[ G] POSIT3                           DD3A
[ G] POSIT4                           DD4E
[ G] POSIT5                           DD68
[ G] POSIT6                           DD7A
[ G] POSIT7                           DD9D
[ G] POSIT8                           DDB2
[ G] PR1                              CCFC
[ G] PUTAV2                           D960
[ G] PUTAVL                           D950
[ G] PUTIR                            D87F
[ G] PUTIR2                           D88A
[ G] PUTNXT                           D585
[ G] PUTRA2                           D5B4
[ G] PUTRA4                           D5B7
[ G] PUTRAN                           D598
[ G] PUTSP2                           D704
[ G] PUTSP4                           D714
[ G] PUTSP6                           D71B
[ G] PUTSPC                           D6FA
[ G] QUKCHK                           DE12
[ G] RDER                             0009
[ G] RDNEX1                           D622
[ G] RDNEX2                           D628
[ G] RDNEX3                           D640
[ G] RDNEX4                           D644
[ G] RDNEX6                           D646
[ G] RDNEX8                           D648
[ G] RDNEXT                           D614
[ G] RDSEQ                            D5FD
[ G] RDSEQ0                           D608
[ G] RDSEQ1                           D60F
[ G] READS2                           D653
[ G] READS4                           D65D
[ G] READS6                           D665
[ G] READSS                           D649
[ G] REMFC2                           D519
[ G] REMFCB                           D510
[ G] RENAM1                           DB51
[ G] RENAM4                           DB70
[ G] RENAM5                           DB74
[ G] RENAM6                           DB75
[ G] RENAME                           DB43
[ G] RESTOR                           DE09
[ G] RETRY                            D678
[ G] RETRY2                           D68D
[ G] RETRY4                           D6A1
[ G] RETRY6                           D6A4
[ G] REWIN2                           D5F8
[ G] REWIND                           D5EA
[ G] RMER                             0019
[ G] RNFMSK                           0010
[ G] RRER                             0018
[ G] RS                               0004
[ G] RSC                              0007
[ G] RSTNA2                           DDCA
[ G] RSTNAM                           DDC5
[ G] RTC                              0005
[ G] SBC                              0037
[ G] SCC                              0009
[ G] SCMSK                            007F
[ G] SECMAP                           D41D
[ G] SETFC2                           D507
[ G] SETFCB                           D4FE
[ G] SETFD                            D90E
[ G] SETFD2                           D91F
[ G] SETMA2                           DCEF
[ G] SETMAX                           DCD8
[ G] SETST                            DA8D
[ G] SINDIR                           D41A
[ G] SL                               0100
[ G] SPC                              0020
[ G] SRDSE2                           D5CA
[ G] SRDSE6                           D5E4
[ G] SRDSE7                           D5E7
[ G] SRDSE8                           D5E9
[ G] SRDSEQ                           D5BC
[ G] STER                             0012
[ G] STRIES                           D412
[ G] SWAP                             DB7A
[ G] SWAP2                            DB82
[ G] SWAP4                            DB9C
[ G] SWAP6                            DBA6
[ G] SWPNM                            DBAA
[ G] SWPNM2                           DBAC
[ G] SWPNM4                           DBB8
[ G] SWPNM5                           DBB9
[ G] SWTSE2                           D6ED
[ G] SWTSE4                           D6F2
[ G] SWTSE6                           D6F7
[ G] SWTSEQ                           D6D7
[ G] TEMP                             D40D
[ G] TMER                             0006
[ G] TRMSK                            007F
[ G] UNLOCK                           C70C
[ G] UPDF75                           DC99
[ G] UPDFS2                           DC66
[ G] UPDFS4                           DC7A
[ G] UPDFS6                           DC91
[ G] UPDFS7                           DC96
[ G] UPDFS8                           DC9E
[ G] UPDFS9                           DCAE
[ G] UPDFSM                           DC5A
[ G] VERIFY                           DE06
[ G] VRFYFG                           D435
[ G] WPER                             000B
[ G] WRITIT                           DBD0
[ G] WRITS2                           D6B1
[ G] WRITS4                           D6C5
[ G] WRITS6                           D6D1
[ G] WRITS7                           D6D2
[ G] WRITS8                           D6D4
[ G] WRITSS                           D6A7
[ G] WRTDI2                           D98C
[ G] WRTDI4                           D98E
[ G] WRTDIR                           D972
[ G] WRTER1                           DBE4
[ G] WRTER2                           DBE8
[ G] WRTER3                           DBEA
[ G] WRTER4                           DBEC
[ G] WRTERR                           DBD8
[ G] WTAPP                            DB1E
[ G] WTAPP2                           DB36
[ G] WTAPP4                           DB3D
[ G] WTAPP6                           DB3E
[ G] WTER                             000A
[ G] WTFSM                            DCAF
[ G] WTFSM2                           DCC3
[ G] WTNEX1                           D77A
[ G] WTNEXT                           D753
[ G] WTSEQ                            D71C
[ G] WTSEQ2                           D736
[ G] WTSEQ4                           D745
